<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>user@cybrealm:~$</title>
    <link>http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/</link>
    <description>Recent content on user@cybrealm:~$</description>
    <generator>Hugo -- gohugo.io</generator>
      <language>en-us</language><atom:link href="http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/1c1-ssrf-against-local-interface-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/1c1-ssrf-against-local-interface-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1c1---ssrf-against-local-interface-portswigger-lab&#34;&gt;
  1c1 - SSRF against local interface [Portswigger Lab]
  &lt;a href=&#34;#1c1---ssrf-against-local-interface-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h3 id=&#34;problem&#34;&gt;
  &lt;strong&gt;Problem&lt;/strong&gt;
  &lt;a href=&#34;#problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at `http://localhost/admin` and delete the user `carlos`.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;URL: &lt;a href=&#34;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&#34;&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So each product page has a functionality to check stock for an item. Clicking &amp;ldquo;Check stock&amp;rdquo; displays number of items in stock&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1c1---ssrf-against-local-interface-portswigger-lab&#34;&gt;
  1c1 - SSRF against local interface [Portswigger Lab]
  &lt;a href=&#34;#1c1---ssrf-against-local-interface-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h3 id=&#34;problem&#34;&gt;
  &lt;strong&gt;Problem&lt;/strong&gt;
  &lt;a href=&#34;#problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at `http://localhost/admin` and delete the user `carlos`.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;URL: &lt;a href=&#34;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&#34;&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So each product page has a functionality to check stock for an item. Clicking &amp;ldquo;Check stock&amp;rdquo; displays number of items in stock&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170709.png&#34; alt=&#34;Check Stock functionality&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Upon checking in BurpSuite, the application makes an API call to some &lt;code&gt;stockApi&lt;/code&gt; URL &lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170830.png&#34; alt=&#34;BurpSuite - API call for stock check&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Changing a &lt;code&gt;stockApi&lt;/code&gt; URL to a &lt;code&gt;loopback&lt;/code&gt; URL such as &lt;code&gt;http://localhost/admin&lt;/code&gt; and then sending a request causes the web application to return an admin interface instead of number of stock items.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170954.png&#34; alt=&#34;admin interface returned&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Pointing to User &lt;code&gt;delete&lt;/code&gt; link points to &lt;code&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/admin/delete?username=wiener&lt;/code&gt;, so if we modify the HTTP request once again to &lt;code&gt;stockApi=http://localhost/admin/delete?username=wiener&lt;/code&gt; it will make a &lt;code&gt;SSRF&lt;/code&gt; call against the local server and issue a command to delete an user &amp;lsquo;wiener&amp;rsquo;&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718171429.png&#34; alt=&#34;removing user weiner&#34;  /&gt;
  &lt;/figure&gt;

</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/1c2-ssrf-against-external-back-end-system-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1c-server-side-vulnerabilities/1c2-ssrf-against-external-back-end-system-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1c2---ssrf-against-external-back-end-system-portswigger-lab&#34;&gt;
  1c2 - SSRF against external back-end system [PortSwigger Lab]
  &lt;a href=&#34;#1c2---ssrf-against-external-back-end-system-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The same principle applies for remote SSRF. An attacker can submit the following request to access the admin interface&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /product/stock HTTP/1.0 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 118

stockApi=http://192.168.0.68/admin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same example as previous, but for remote API:&lt;/p&gt;
&lt;p&gt;a Webapplication makes a request for stock check at &lt;code&gt;http://192.168.0.1:8080/product/stock/check?productId=1&amp;amp;storeId=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we know that API is in this range &lt;code&gt;http://192.168.0.X:8080&lt;/code&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1c2---ssrf-against-external-back-end-system-portswigger-lab&#34;&gt;
  1c2 - SSRF against external back-end system [PortSwigger Lab]
  &lt;a href=&#34;#1c2---ssrf-against-external-back-end-system-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The same principle applies for remote SSRF. An attacker can submit the following request to access the admin interface&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /product/stock HTTP/1.0 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 118

stockApi=http://192.168.0.68/admin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same example as previous, but for remote API:&lt;/p&gt;
&lt;p&gt;a Webapplication makes a request for stock check at &lt;code&gt;http://192.168.0.1:8080/product/stock/check?productId=1&amp;amp;storeId=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we know that API is in this range &lt;code&gt;http://192.168.0.X:8080&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;so to find it we use BurpSuite Intruder&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;make payloads 1-254&lt;/li&gt;
&lt;li&gt;run Start Attack&lt;/li&gt;
&lt;li&gt;wait for status code 200&lt;/li&gt;
&lt;li&gt;&lt;code&gt;http://192.168.0.30:8080/admin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;change request header upon clicking &lt;em&gt;Check Stock&lt;/em&gt; to &lt;code&gt;stockApi=http://192.168.0.30/admin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;admin panel opens up&lt;/li&gt;
&lt;li&gt;make request again &lt;code&gt;stockApi=http://192.168.0.30/admin/delete?username=carlos&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;send&lt;/li&gt;
&lt;li&gt;done&lt;/li&gt;
&lt;/ol&gt;
</content>
    </item>
  </channel>
</rss>
